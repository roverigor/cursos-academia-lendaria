---
lesson_id: "4.1"
title: "Instalando Evolution API"
module: 4
module_name: "WhatsApp: Evolution API"
duration_minutes: 8
format: video_script
status: draft
tool: evolution-api
substitutes: "Twilio, Z-API, API Oficial WhatsApp"
savings_year: 1800
connection_dre: "Economia R$ 1.800+/ano em API de WhatsApp"
learning_objectives:
  - Instalar Evolution API via Portainer
  - Configurar variáveis de ambiente
  - Acessar o painel pela primeira vez
prerequisites:
  - Módulo 3 completo (Portainer funcionando)
---

# AULA 4.1: Instalando Evolution API

## METADADOS DA GRAVAÇÃO

| Item | Valor |
|------|-------|
| Duração alvo | 8 minutos |
| Cenário | Tela compartilhada (Portainer + Navegador) |
| Tom | Empolgante, "primeira ferramenta real" |

---

## ROTEIRO COMPLETO

### [CONEXÃO DRE] - 20 segundos

**[INSTRUTOR NA CÂMERA]**

> Primeira ferramenta de verdade!
>
> Evolution API é uma API de WhatsApp gratuita.
>
> Substitui Twilio, Z-API, e outras que cobram R$ 150+/mês.
>
> Economia: **R$ 1.800+/ano**. Vamos instalar.

---

### [O QUE É EVOLUTION API] - 30 segundos

**[TELA: Site/Docs da Evolution]**

> Evolution API permite:
>
> - Enviar e receber mensagens WhatsApp
> - Integrar com N8N, Chatwoot, etc.
> - Webhooks pra automações
>
> **[INSTRUTOR NA CÂMERA]**
>
> É a base pra tudo que envolve WhatsApp nas suas automações.
>
> E o melhor: gratuita, self-hosted, seus dados.

---

### [INSTALAÇÃO VIA PORTAINER] - 4 minutos

**[TELA: Portainer]**

> Abre o Portainer: `portainer.seudominio.com.br`
>
> **[NAVEGA]**
>
> Stacks → Add Stack
>
> Nome: `evolution`
>
> **[COLA O COMPOSE]**

```yaml
version: "3.8"

services:
  evolution:
    image: atendai/evolution-api:latest
    container_name: evolution
    restart: unless-stopped
    environment:
      - SERVER_URL=https://evolution.seudominio.com.br
      - AUTHENTICATION_API_KEY=sua_chave_secreta_aqui
      - AUTHENTICATION_EXPOSE_IN_FETCH_INSTANCES=true
      - DATABASE_ENABLED=true
      - DATABASE_PROVIDER=postgresql
      - DATABASE_CONNECTION_URI=postgresql://postgres:postgres@evolution_db:5432/evolution
      - DATABASE_SAVE_DATA_INSTANCE=true
      - DATABASE_SAVE_DATA_NEW_MESSAGE=true
      - DATABASE_SAVE_MESSAGE_UPDATE=true
      - DATABASE_SAVE_DATA_CONTACTS=true
      - DATABASE_SAVE_DATA_CHATS=true
    volumes:
      - evolution_instances:/evolution/instances
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.evolution.rule=Host(`evolution.seudominio.com.br`)"
      - "traefik.http.routers.evolution.entrypoints=websecure"
      - "traefik.http.routers.evolution.tls.certresolver=letsencrypt"
      - "traefik.http.services.evolution.loadbalancer.server.port=8080"
    networks:
      - traefik_proxy
    depends_on:
      - evolution_db

  evolution_db:
    image: postgres:15
    container_name: evolution_db
    restart: unless-stopped
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DB=evolution
    volumes:
      - evolution_postgres:/var/lib/postgresql/data
    networks:
      - traefik_proxy

volumes:
  evolution_instances:
  evolution_postgres:

networks:
  traefik_proxy:
    external: true
```

> **[EXPLICA ENQUANTO COLA]**
>
> Coisas pra trocar:
> 1. `seudominio.com.br` → seu domínio real
> 2. `sua_chave_secreta_aqui` → uma chave forte (tipo senha longa)
>
> **[DICA]**
>
> Pra gerar uma chave, pode usar:
> - `openssl rand -hex 32` no terminal
> - Ou inventa uma frase longa sem espaços
>
> **[CLICA DEPLOY]**
>
> Deploy the stack.
>
> **[ESPERA]**
>
> Pode demorar 1-2 minutos na primeira vez (baixa as imagens).

---

### [PRIMEIRO ACESSO] - 60 segundos

**[TELA: Navegador]**

> Acessa: `https://evolution.seudominio.com.br`
>
> **[MOSTRA TELA]**
>
> Você vai ver a documentação da API (Swagger).
>
> **[MOSTRA SWAGGER]**
>
> Isso significa que tá funcionando!
>
> A Evolution não tem painel visual por padrão — ela é uma API.
>
> Você vai interagir via:
> - Integração com N8N
> - Integração com Chatwoot
> - Requisições HTTP

---

### [TESTANDO A API] - 60 segundos

**[TELA: Swagger ou terminal]**

> Vamos testar se tá funcionando.
>
> No Swagger, procura o endpoint `/instance/create`
>
> **[MOSTRA]**
>
> Ou via curl (opcional):
>
> ```bash
> curl -X POST "https://evolution.seudominio.com.br/instance/create" \
>   -H "apikey: sua_chave_secreta_aqui" \
>   -H "Content-Type: application/json" \
>   -d '{"instanceName": "teste"}'
> ```
>
> **[MOSTRA RESPOSTA]**
>
> Se retornar dados da instância, API funcionando!

---

### [CHECKPOINT] - 20 segundos

**[INSTRUTOR NA CÂMERA]**

> **CHECKPOINT:**
>
> - ✅ Evolution acessível em `evolution.seudominio.com.br`
> - ✅ HTTPS funcionando (cadeado verde)
> - ✅ Swagger/Documentação carregando
>
> Na próxima aula, conectamos seu WhatsApp e fazemos o primeiro teste real.

---

## NOTAS DE PRODUÇÃO

### Elementos visuais:
- Portainer criando a stack
- Swagger da Evolution API
- Teste de endpoint

### Tom de voz:
- Empolgante: "Primeira ferramenta de verdade!"
- Técnico mas acessível
- "R$ 1.800/ano de economia"

### Pontos de atenção:
- API Key deve ser forte e secreta
- Postgres incluído no compose pra facilitar
- Evolution v2 usa formato diferente de versões antigas

### Duração real: 8 minutos
