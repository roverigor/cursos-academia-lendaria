# AULA 3.4: Merge e Conflitos sem Pânico

**Módulo:** 3 - Colaboração Profissional
**Duração:** 15 minutos
**Tipo:** Prático

---

## GPS DA AULA

### DESTINO (Onde você vai chegar)
Ao final desta aula, você vai:
- Fazer merge de branches com confiança
- Resolver conflitos sem pânico
- Identificar e editar marcadores de conflito
- Manter histórico limpo e funcional

### ORIGEM (De onde você vem)
Você provavelmente:
- Sabe criar PRs e fazer review (aulas anteriores)
- Tem medo de conflitos de merge
- Talvez já tenha perdido código tentando resolver conflito

### ROTA (Como vamos chegar)
1. Entender como conflitos acontecem
2. Aprender a identificar marcadores
3. Resolver conflito passo a passo
4. Praticar com conflito simulado

---

## ROTEIRO COMPLETO

### [ABERTURA] - 30 segundos

**[PROFESSOR DIZ:]**

> Conflitos de merge. O terror de todo iniciante.
>
> Mas aqui está a verdade: conflitos são normais. Em times reais, acontecem todo dia.
>
> Não é um erro. É uma situação que precisa de decisão humana.
>
> Nessa aula você vai perder o medo. Bora.

---

### [COMO CONFLITOS ACONTECEM] - 2 minutos

[SLIDE 1 - Diagrama de conflito]

**[PROFESSOR DIZ:]**

> Conflito acontece quando duas pessoas editam a **mesma parte** do **mesmo arquivo**.
>
> Olha esse cenário:
>
> Você está na branch `feature/formal`. Você muda a função greet pra retornar "Good morning".
>
> Seu colega está na branch `feature/casual`. Ele muda a mesma função pra retornar "Hey".
>
> [SLIDE 2 - Duas versões]
>
> Quando tenta juntar as duas branches, o Git não sabe qual manter.
>
> "Good morning" ou "Hey"? Você precisa decidir.
>
> [Pausa]
>
> Importante: conflito só acontece quando **a mesma linha** é editada diferente. Se vocês editaram linhas diferentes, o Git mescla automaticamente.

---

### [DETECTANDO CONFLITOS] - 1 minuto

[SLIDE 3 - Mensagem de conflito]

**[PROFESSOR DIZ:]**

> Quando você tenta fazer merge e tem conflito, o Git avisa:
>
> ```
> Auto-merging index.js
> CONFLICT (content): Merge conflict in index.js
> Automatic merge failed; fix conflicts and then commit the result.
> ```
>
> Não é um erro fatal. É só o Git dizendo: "preciso que você decida".
>
> [SLIDE 4 - git status durante conflito]
>
> Se você rodar `git status`:
>
> ```
> Unmerged paths:
>   both modified:   index.js
> ```
>
> Mostra exatamente quais arquivos têm conflito.

---

### [ANATOMIA DO CONFLITO] - 2 minutos

[SLIDE 5 - Marcadores de conflito]

**[PROFESSOR DIZ:]**

> Quando abre o arquivo com conflito, você vê isso:
>
> ```javascript
> function greet(name) {
> <<<<<<< HEAD
>   return "Good morning, " + name;
> =======
>   return "Hey " + name;
> >>>>>>> feature/casual
> }
> ```
>
> Esses são os marcadores de conflito.
>
> [SLIDE 6 - Explicação dos marcadores]
>
> `<<<<<<< HEAD` - início do conflito, versão atual (sua branch)
>
> `=======` - separador entre as versões
>
> `>>>>>>> branch` - fim do conflito, versão da outra branch
>
> [Pausa]
>
> Seu trabalho é: escolher qual versão manter, ou combinar as duas, e **deletar todos os marcadores**.

---

### [RESOLVENDO PASSO A PASSO] - 3 minutos

[SLIDE 7 - Passo 1]

**[PROFESSOR DIZ:]**

> Vamos resolver juntos.
>
> **Passo 1: Identifique os arquivos.**
>
> ```bash
> git status
> ```
>
> Lista "both modified". Esses são os arquivos com conflito.
>
> [SLIDE 8 - Passo 2]
>
> **Passo 2: Abra o arquivo e escolha.**
>
> Você tem 4 opções:
>
> Opção 1 - Manter sua versão:
> ```javascript
> function greet(name) {
>   return "Good morning, " + name;
> }
> ```
>
> Opção 2 - Manter versão deles:
> ```javascript
> function greet(name) {
>   return "Hey " + name;
> }
> ```
>
> [SLIDE 9 - Opções 3 e 4]
>
> Opção 3 - Combinar as duas (mais comum):
> ```javascript
> function greet(name, style = 'formal') {
>   return style === 'formal'
>     ? "Good morning, " + name
>     : "Hey " + name;
> }
> ```
>
> Opção 4 - Escrever algo completamente novo.
>
> [Pausa]
>
> O importante: **delete todos os marcadores**. `<<<<<<<`, `=======`, `>>>>>>>`. Todos.
>
> [SLIDE 10 - Passos 3-6]
>
> **Passo 3: Teste que funciona.**
>
> ```bash
> npm test  # ou rode manualmente
> ```
>
> Nunca commite sem testar!
>
> **Passo 4: Marque como resolvido.**
>
> ```bash
> git add index.js
> ```
>
> **Passo 5: Complete o merge.**
>
> ```bash
> git commit
> ```
>
> Mensagem padrão já vem: "Merge branch 'feature/casual' into main".
>
> **Passo 6: Push.**
>
> ```bash
> git push
> ```
>
> Conflito resolvido!

---

### [EXERCÍCIO AO VIVO] - 4 minutos

[SLIDE 11 - Exercício]

**[PROFESSOR DIZ:]**

> Vamos criar e resolver um conflito.
>
> ```bash
> cd github-practice-repo
>
> # Cria primeira branch
> git checkout main
> git checkout -b feature/greeting-formal
> echo "function greet(name) { return 'Good morning, ' + name; }" > greet.js
> git add greet.js
> git commit -m "feat: add formal greeting"
>
> # Volta pra main, cria segunda branch
> git checkout main
> git checkout -b feature/greeting-casual
> echo "function greet(name) { return 'Hey ' + name; }" > greet.js
> git add greet.js
> git commit -m "feat: add casual greeting"
> ```
>
> [Pausa]
>
> Agora vamos causar o conflito:
>
> ```bash
> # Merge primeira branch na main
> git checkout main
> git merge feature/greeting-formal
> # Funciona, sem conflito
>
> # Tenta merge segunda branch
> git merge feature/greeting-casual
> # CONFLITO!
> ```
>
> [Pausa]
>
> Veja o conflito:
>
> ```bash
> cat greet.js
> ```
>
> Você vê os marcadores `<<<<<<<`, `=======`, `>>>>>>>`.
>
> Agora resolve. Edita o arquivo pra combinar as duas versões:
>
> ```javascript
> function greet(name, style = 'formal') {
>   return style === 'formal'
>     ? 'Good morning, ' + name
>     : 'Hey ' + name;
> }
> ```
>
> Complete:
>
> ```bash
> git add greet.js
> git commit -m "merge: combine formal and casual greetings"
> git push
> ```
>
> Conflito resolvido!

---

### [ABORTANDO MERGE] - 30 segundos

[SLIDE 12 - Abort]

**[PROFESSOR DIZ:]**

> Se você entrar em pânico ou quiser desistir:
>
> ```bash
> git merge --abort
> ```
>
> Volta tudo como estava antes. Sem danos.
>
> Use quando:
> - Conflito muito complexo
> - Quer revisar código antes
> - Mergeou branch errada

---

### [FECHAMENTO] - 30 segundos

[SLIDE 13 - Resumo]

**[PROFESSOR DIZ:]**

> Recapitulando:
>
> - Conflitos são normais, não são erros
> - Marcadores: `<<<<<<<`, `=======`, `>>>>>>>`
> - Delete todos os marcadores ao resolver
> - Sempre teste antes de commitar
> - `git merge --abort` se precisar desistir
>
> Você completou o Módulo 3! Agora sabe colaborar profissionalmente: branches, PRs, review, e conflitos.
>
> No Módulo 4, a gente vai aprender a desfazer erros e construir seu perfil profissional no GitHub.
>
> Te vejo lá.

---

## CHECKLIST DE ENTENDIMENTO

- [ ] Entendo que conflitos são normais
- [ ] Sei identificar marcadores de conflito
- [ ] Resolvo conflitos editando arquivo manualmente
- [ ] Sempre testo antes de commitar
- [ ] Sei abortar merge se necessário

---

## ARTEFATO DA AULA

```
AULA 3.4 - MERGE E CONFLITOS
============================

CONFLITO SIMULADO:
[ ] Criei duas branches conflitantes
[ ] Tentei merge e recebi mensagem de conflito

RESOLUÇÃO:
[ ] Identifiquei marcadores (<<<<<<<, =======, >>>>>>>)
[ ] Escolhi/combinei versões
[ ] Removi todos os marcadores
[ ] Testei código após resolução

MERGE COMPLETO:
[ ] git add arquivo-resolvido
[ ] git commit
[ ] git push

VERIFICAÇÃO:
[ ] git log mostra merge commit
[ ] Código funciona corretamente
```

---

## PROMPT DE IA PARA CONFLITOS

```
Me ajude a resolver conflito de merge no Git.

ARQUIVO COM CONFLITO:
[colar conteúdo do arquivo com marcadores]

CONTEXTO:
- Branch atual: [nome]
- Branch sendo merged: [nome]
- O que minha versão faz: [descrever]
- O que versão deles faz: [descrever]

AJUDE A:
1. Explicar o que cada versão faz
2. Sugerir melhor forma de combinar
3. Mostrar código resolvido
4. Explicar por que essa solução
```

---

## TROUBLESHOOTING

### Erro: "You have unstaged changes"

> Commit ou stash antes de merge:
> ```bash
> git stash
> git merge feature/branch
> git stash pop
> ```

### Conflito resolvido mas git status ainda mostra conflito

> Você esqueceu de fazer git add:
> ```bash
> git add arquivo-resolvido.js
> git status
> # Deve mostrar "All conflicts fixed"
> ```

### Conflito muito complexo

> Aborte e peça ajuda:
> ```bash
> git merge --abort
> # Discuta com colega que fez as outras mudanças
> ```

---

## ANEXO: SLIDES NECESSÁRIOS

| # | Título | Conteúdo |
|---|--------|----------|
| 1 | Diagrama de conflito | Duas branches editando mesmo arquivo |
| 2 | Duas versões | Comparativo lado a lado |
| 3 | Mensagem de conflito | Output do terminal |
| 4 | git status | Unmerged paths |
| 5 | Marcadores | <<<<<<<, =======, >>>>>>> |
| 6 | Explicação | O que cada marcador significa |
| 7 | Passo 1 | git status |
| 8 | Passo 2 | Escolher versão |
| 9 | Opções 3 e 4 | Combinar ou reescrever |
| 10 | Passos 3-6 | Teste, add, commit, push |
| 11 | Exercício | Simulação passo a passo |
| 12 | Abort | git merge --abort |
| 13 | Resumo | Checklist visual |

---

## COMANDOS DA AULA (COPIAR E COLAR)

```bash
# Ver arquivos em conflito
git status

# Abortar merge se precisar
git merge --abort

# Após resolver conflito no arquivo
git add arquivo-resolvido.js

# Completar merge
git commit

# Enviar
git push

# Ver histórico com merge
git log --oneline --graph
```

---

## FIM DO MÓDULO 3

Parabéns! Você completou o Módulo 3 - Colaboração Profissional.

Você agora sabe:
- Criar e gerenciar branches
- Abrir Pull Requests profissionais
- Revisar código de forma construtiva
- Resolver conflitos de merge

**Próximo:** Módulo 4 - Sobrevivência e Portfolio

---

**Duração real:** 15 minutos
**Próximo:** Aula 4.1 - Desfazendo Erros
