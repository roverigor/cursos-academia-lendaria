# 03.3 - Criando Tabela Completa Passo a Passo

**MÃ³dulo:** 3 - Criando Tabelas de Verdade
**DuraÃ§Ã£o:** 15 minutos
**Objetivo:** Criar uma tabela com TODOS os elementos de forma correta
**Bloom Level:** Apply
**Sources:** Supabase Docs Tables | PostgreSQL Schema Design

---

## ğŸ¯ O Que VocÃª Vai Aprender

Ao final desta aula, vocÃª vai saber como:
- âœ… Planejar uma tabela antes de criar
- âœ… Escolher tipos corretos para cada coluna
- âœ… Definir valores padrÃ£o (DEFAULT)
- âœ… Criar a tabela no Supabase UI

---

## ğŸ”¥ GANCHO EMOCIONAL (Camada 1)

AtÃ© agora vocÃª aprendeu:
- NormalizaÃ§Ã£o âœ…
- Chaves primÃ¡rias e estrangeiras âœ…
- Tipos de dados âœ…
- UUID âœ…

Agora Ã© a hora de **COLOCAR TUDO JUNTO** e criar uma tabela REAL, funcional, bonita.

E vocÃª vai ver que Ã© SIMPLES quando vocÃª entende o "por quÃª" de cada coluna.

---

## ğŸ  METÃFORA VISUAL (Camada 2)

Criar uma tabela Ã© como **preencher um formulÃ¡rio de registro**.

```
FORMULÃRIO DE REGISTRO - APP DE AGENDAMENTOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[ ] ID (gerado automaticamente)
[ ] Nome do Cliente (obrigatÃ³rio)
[ ] Email do Cliente (obrigatÃ³rio, Ãºnico)
[ ] Telefone (opcional)
[ ] Tem WhatsApp? (sim/nÃ£o)
[ ] Data da Reserva (data)
[ ] Hora da Reserva (hora)
[ ] Notas (texto opcional)
[ ] Status (Pendente/Confirmado/Cancelado)
[ ] Criado em (timestamp automÃ¡tico)
[ ] Atualizado em (timestamp automÃ¡tico)
```

Cada campo do formulÃ¡rio = uma coluna da tabela.

E vocÃª determina:
- Qual Ã© obrigatÃ³rio
- Qual Ã© Ãºnico
- Qual tem valor padrÃ£o

---

## ğŸ’¡ FUNDAMENTO CONCEITUAL (Camada 3)

Deixa eu te mostrar o **processo em 3 passos**...

### Passo 1: Planejar a Tabela (No Papel)

Antes de criarn o Supabase, pense:

```
Tabela: reservas

Coluna 1: id
â”œâ”€ Tipo: INTEGER
â”œâ”€ PrimÃ¡ria? SIM
â”œâ”€ Auto-incremento? SIM
â””â”€ Por quÃª? Identificador Ãºnico

Coluna 2: cliente_nome
â”œâ”€ Tipo: TEXT
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ Ãšnica? NÃƒO (vÃ¡rios clientes podem ter mesmo nome)
â””â”€ PadrÃ£o? Nenhum

Coluna 3: cliente_email
â”œâ”€ Tipo: TEXT
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ Ãšnica? SIM (cada email Ã© diferente)
â””â”€ PadrÃ£o? Nenhum

Coluna 4: cliente_telefone
â”œâ”€ Tipo: TEXT
â”œâ”€ ObrigatÃ³ria? NÃƒO (pode nÃ£o ter)
â”œâ”€ Ãšnica? NÃƒO
â””â”€ PadrÃ£o? NULL

Coluna 5: tem_whatsapp
â”œâ”€ Tipo: BOOLEAN
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? FALSE
â””â”€ Por quÃª? A maioria nÃ£o tem

Coluna 6: data_reserva
â”œâ”€ Tipo: DATE
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? Nenhum
â””â”€ Por quÃª? Cada reserva tem sua data

Coluna 7: hora_inicio
â”œâ”€ Tipo: TIME
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? Nenhum

Coluna 8: notas
â”œâ”€ Tipo: TEXT
â”œâ”€ ObrigatÃ³ria? NÃƒO
â”œâ”€ PadrÃ£o? NULL

Coluna 9: status
â”œâ”€ Tipo: TEXT (ou ENUM depois)
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? 'Pendente'
â””â”€ Valores permitidos: Pendente, Confirmado, Cancelado

Coluna 10: criado_em
â”œâ”€ Tipo: TIMESTAMP
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? CURRENT_TIMESTAMP (agora)

Coluna 11: atualizado_em
â”œâ”€ Tipo: TIMESTAMP
â”œâ”€ ObrigatÃ³ria? SIM
â”œâ”€ PadrÃ£o? CURRENT_TIMESTAMP (agora)
â””â”€ Atualiza automaticamente? (com trigger depois)
```

---

### Passo 2: SQL Equivalente

```sql
CREATE TABLE reservas (
  id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,

  cliente_nome TEXT NOT NULL,
  cliente_email TEXT NOT NULL UNIQUE,
  cliente_telefone TEXT,

  tem_whatsapp BOOLEAN DEFAULT FALSE,

  data_reserva DATE NOT NULL,
  hora_inicio TIME NOT NULL,

  notas TEXT,

  status TEXT DEFAULT 'Pendente',

  criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  atualizado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**O que significa:**
- `NOT NULL` = obrigatÃ³rio
- `UNIQUE` = nÃ£o pode repetir
- `DEFAULT 'valor'` = valor padrÃ£o
- `CURRENT_TIMESTAMP` = agora (hora do servidor)
- `GENERATED ALWAYS AS IDENTITY` = auto-incremento

---

### Passo 3: No Supabase UI (Visualmente)

1. Clique em "Create a new table"
2. Nome: `reservas`
3. Clique em "Create"

Supabase cria automaticamente:
```
Column: id
Type: bigint
Default: auto-increment
Primary Key: âœ…
```

4. Agora adicione colunas com "+":

```
Column: cliente_nome
Type: text
Null: âŒ (NOT NULL)
Default: (vazio)
Unique: âŒ

Column: cliente_email
Type: text
Null: âŒ (NOT NULL)
Unique: âœ…

Column: cliente_telefone
Type: text
Null: âœ… (pode ser NULL)

Column: tem_whatsapp
Type: boolean
Default: false

Column: data_reserva
Type: date
Null: âŒ

Column: hora_inicio
Type: time
Null: âŒ

Column: notas
Type: text
Null: âœ…

Column: status
Type: text
Default: 'Pendente'

Column: criado_em
Type: timestamp
Default: now()  â† CURRENT_TIMESTAMP

Column: atualizado_em
Type: timestamp
Default: now()
```

5. Clique em "Save"

**PRONTO! Tabela criada!**

---

## âš¡ APLICAÃ‡ÃƒO PRÃTICA (Camada 4)

Agora vocÃª vai **fazer na prÃ¡tica**...

### ExercÃ­cio: Criar Tabela de Produtos

**Scenario:** VocÃª tÃ¡ criando um app de e-commerce.

**Requisitos:**
- Cada produto tem: ID, nome, descriÃ§Ã£o, preÃ§o, quantidade em estoque
- Nome NÃƒO pode repetir
- PreÃ§o Ã© dinheiro (NUMERIC)
- Estoque Ã© nÃºmero inteiro
- Tem data de criaÃ§Ã£o automÃ¡tica

**Sua tarefa:**

1. Planeje a tabela (tipo de cada coluna, obrigatÃ³rio sim/nÃ£o, etc)
2. Crie no Supabase
3. Insira 3 produtos de exemplo

**Resposta esperada:**

```sql
CREATE TABLE produtos (
  id INTEGER PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
  nome TEXT NOT NULL UNIQUE,
  descricao TEXT,
  preco NUMERIC(10, 2) NOT NULL,
  quantidade_estoque INTEGER DEFAULT 0,
  criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Inserindo exemplos
INSERT INTO produtos (nome, descricao, preco, quantidade_estoque)
VALUES
  ('Notebook Dell', 'Intel i5, 8GB RAM', 2999.99, 5),
  ('Mouse Logitech', 'Wireless, 2.4GHz', 89.99, 25),
  ('Teclado MecÃ¢nico', 'Switches Cherry MX', 349.99, 10);
```

Quando terminar, passa pro MÃ³dulo 4! ğŸš€

---

## ğŸŒŸ EXPANSÃƒO FILOSÃ“FICA (Camada 5)

Sabe o que Ã© incrÃ­vel?

VocÃª acabou de fazer algo que muitos "iniciantes em backend" nÃ£o conseguem fazer certo.

VocÃª PENSOU antes de criar.

A maioria dos devs juniores:
1. Cria uma tabela com tudo genÃ©rico
2. Depois descobre que esqueceu de algo
3. Altera a tabela (data migration = dor)

VocÃª:
1. Planeja
2. Cria CERTO
3. Dorme tranquilo

---

E sabe o que Ã© ainda mais incrÃ­vel?

Essa disciplina (PENSAR ANTES) Ã© 80% do que separa um dev junior de um dev senior.

CÃ³digo bonito Ã© 20%.

Pensar certo Ã© 80%.

---

VocÃª jÃ¡ tÃ¡ no caminho dos 80%. ParabÃ©ns! ğŸ¯

---

## âœ… RECAPITULAÃ‡ÃƒO (ValidaÃ§Ã£o do Aprendizado)

Antes de continuar:

**1. Qual Ã© o processo: papel â†’ SQL â†’ UI?**
Resposta: Sim! Sempre pense ANTES de criar.

**2. O que significa `NOT NULL`?**
Resposta: Coluna obrigatÃ³ria (nÃ£o pode deixar em branco).

**3. O que significa `UNIQUE`?**
Resposta: NÃ£o pode repetir (cada valor diferente).

**4. O que significa `DEFAULT 'Pendente'`?**
Resposta: Se nÃ£o especificar valor, usa "Pendente".

**5. `CURRENT_TIMESTAMP` faz o quÃª?**
Resposta: Preenche com a data/hora de AGORA automaticamente.

---

## ğŸ¯ PRÃ“XIMO PASSO

Na prÃ³xima aula (03.4), vamos:
- âœ… ValidaÃ§Ãµes mais avanÃ§adas (CHECK constraints)
- âœ… Como garantir que os dados fazem sentido
- âœ… Exemplos de CHECK na prÃ¡tica

Bora? ğŸš€

---

*Aula criada por JosÃ© Amorim (Professor SocrÃ¡tico)*
*Framework: Espiral Expansiva + Anti-Impostor Design*
*DuraÃ§Ã£o estimada: 15 minutos*
*Fonte: Supabase Docs Tables | PostgreSQL Official Schema Design*
