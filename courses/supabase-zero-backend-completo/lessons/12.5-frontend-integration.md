# 12.5 - Frontend Integration

**Dura√ß√£o:** 20 minutos | **Tipo:** Create | **Bloom:** Criar | **Framework:** Espiral Expansiva

---

## üé£ GANCHO EMOCIONAL

Voc√™ tem database seguro. Auth funcionando. RLS protegendo.

A√≠ voc√™ pensa: "√ìtimo, mas usu√°rio precisa de **interface**".

Porque linhas de SQL n√£o v√£o fazer o usu√°rio feliz.

O usu√°rio quer **clicar e ver seus projects aparecerem magicamente**.

Nesta aula voc√™ cria interface. Formul√°rios. Listagens. Componentes.

Voc√™ transforma dados em experi√™ncia.

---

## üé≠ MET√ÅFORA VISUAL

Banco de dados + Frontend = **Restaurante**

Database = cozinha (dados, opera√ß√µes, seguran√ßa)
Frontend = sal√£o (interface, experi√™ncia, beleza)

Cozinha perfeita sem sal√£o bonito? Ningu√©m entra.
Sal√£o lindo com cozinha ruim? Comida √© horr√≠vel.

Voc√™ precisa dos DOIS. E bem integrados.

---

## üß† FUNDAMENTO CONCEITUAL

Frontend integration tem **4 etapas:**

1. **Layout base** (App shell)
2. **Componentes** (Reusable)
3. **Queries** (Fetch dados)
4. **State management** (React State/Context)

---

## ‚öôÔ∏è APLICA√á√ÉO PR√ÅTICA

### Layout Base (app/layout.tsx)

```typescript
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { Session } from '@supabase/supabase-js'
import Navbar from '@/components/Navbar'
import Sidebar from '@/components/Sidebar'

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const [session, setSession] = useState<Session | null>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session)
      setLoading(false)
    })

    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((_event, session) => {
      setSession(session)
    })

    return () => subscription.unsubscribe()
  }, [])

  if (loading) {
    return <div className="flex items-center justify-center h-screen">Carregando...</div>
  }

  if (!session) {
    return <LoginPage />
  }

  return (
    <div className="flex h-screen bg-gray-50">
      <Sidebar />
      <div className="flex-1 flex flex-col">
        <Navbar />
        <main className="flex-1 overflow-y-auto">
          {children}
        </main>
      </div>
    </div>
  )
}
```

### Projects Page (app/projects/page.tsx)

```typescript
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import ProjectCard from '@/components/ProjectCard'
import CreateProjectForm from '@/components/CreateProjectForm'

type Project = {
  id: string
  name: string
  description: string
  created_at: string
  owner_id: string
}

export default function ProjectsPage() {
  const [projects, setProjects] = useState<Project[]>([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchProjects()
  }, [])

  async function fetchProjects() {
    try {
      const { data, error } = await supabase
        .from('projects')
        .select('*')
        .order('created_at', { ascending: false })

      if (error) throw error
      setProjects(data || [])
    } catch (error) {
      console.error('Error:', error)
    } finally {
      setLoading(false)
    }
  }

  async function handleCreateProject(name: string, description: string) {
    const {
      data: { user },
    } = await supabase.auth.getUser()

    const { data, error } = await supabase
      .from('projects')
      .insert([
        {
          name,
          description,
          owner_id: user?.id,
        },
      ])
      .select()

    if (!error && data) {
      setProjects([data[0], ...projects])
    }
  }

  if (loading) return <div>Carregando...</div>

  return (
    <div className="p-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold mb-4">Meus Projetos</h1>
        <CreateProjectForm onSubmit={handleCreateProject} />
      </div>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        {projects.map((project) => (
          <ProjectCard key={project.id} project={project} />
        ))}
      </div>
    </div>
  )
}
```

### Project Detail Page (app/projects/[id]/page.tsx)

```typescript
'use client'

import { useEffect, useState } from 'react'
import { supabase } from '@/lib/supabase'
import TaskList from '@/components/TaskList'
import TaskForm from '@/components/TaskForm'

type Task = {
  id: string
  title: string
  status: 'todo' | 'in_progress' | 'done'
  priority: 'low' | 'medium' | 'high'
  assigned_to?: string
  created_at: string
}

export default function ProjectPage({ params }: { params: { id: string } }) {
  const [tasks, setTasks] = useState<Task[]>([])
  const [project, setProject] = useState<any>(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    fetchProject()
    fetchTasks()
  }, [params.id])

  async function fetchProject() {
    const { data } = await supabase
      .from('projects')
      .select('*')
      .eq('id', params.id)
      .single()
    setProject(data)
  }

  async function fetchTasks() {
    const { data } = await supabase
      .from('tasks')
      .select('*')
      .eq('project_id', params.id)
      .order('created_at', { ascending: false })
    setTasks(data || [])
    setLoading(false)
  }

  async function handleCreateTask(title: string, priority: string) {
    const { data } = await supabase
      .from('tasks')
      .insert([{ project_id: params.id, title, priority }])
      .select()

    if (data) setTasks([data[0], ...tasks])
  }

  async function handleUpdateTask(taskId: string, updates: any) {
    await supabase.from('tasks').update(updates).eq('id', taskId)
    setTasks(tasks.map(t => t.id === taskId ? { ...t, ...updates } : t))
  }

  if (loading) return <div>Carregando...</div>

  return (
    <div className="p-8">
      <h1 className="text-3xl font-bold mb-8">{project?.name}</h1>

      <div className="mb-8">
        <TaskForm onSubmit={handleCreateTask} />
      </div>

      <TaskList
        tasks={tasks}
        onUpdateTask={handleUpdateTask}
      />
    </div>
  )
}
```

### Componentes Reutiliz√°veis

```typescript
// components/ProjectCard.tsx
export default function ProjectCard({ project }: { project: any }) {
  return (
    <div className="bg-white rounded-lg shadow p-6 hover:shadow-lg transition">
      <h3 className="text-xl font-bold mb-2">{project.name}</h3>
      <p className="text-gray-600 mb-4">{project.description}</p>
      <a href={`/projects/${project.id}`} className="text-blue-600 hover:underline">
        Ver Detalhes ‚Üí
      </a>
    </div>
  )
}

// components/TaskItem.tsx
export default function TaskItem({ task, onUpdate }: any) {
  const statusColors = {
    todo: 'bg-gray-200',
    in_progress: 'bg-yellow-200',
    done: 'bg-green-200',
  }

  return (
    <div className="flex items-center gap-4 p-4 bg-white rounded border mb-2">
      <input type="checkbox" checked={task.status === 'done'} />
      <div className="flex-1">
        <h4 className={task.status === 'done' ? 'line-through' : ''}>
          {task.title}
        </h4>
        <span className={`text-xs px-2 py-1 rounded ${statusColors[task.status]}`}>
          {task.status}
        </span>
      </div>
      <button
        onClick={() => onUpdate(task.id, { status: task.status === 'done' ? 'todo' : 'done' })}
        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
      >
        {task.status === 'done' ? 'Reabrir' : 'Completar'}
      </button>
    </div>
  )
}
```

---

## üå≥ EXPANS√ÉO FILOS√ìFICA

Frontend √© onde o usu√°rio vive.

Database pode ser perfeito. Code pode ser limpo. Mas se interface √© ruim, usu√°rio odeia.

Bom frontend = usu√°rio feliz = neg√≥cio cresce

Quando voc√™ dedica tempo em interface:
- Usu√°rio consegue achar coisas
- A√ß√µes s√£o claras
- Feedback √© imediato
- Experi√™ncia √© suave

---

## ‚úÖ RECAPITULA√á√ÉO

5 pontos:

1. **Layout base:** App shell com navbar/sidebar
2. **Componentes:** Reutiliz√°veis e test√°veis
3. **Queries:** Fetch dados com Supabase client
4. **State:** useState pra dados, useEffect pra updates
5. **UX:** Feedback claro, loading states, error handling

---

## üéØ EXERC√çCIO PR√ÅTICO

**Objetivo:** Criar p√°gina de projects e tasks

**Tempo:** 20-25 minutos

### Criar estrutura:

```bash
mkdir -p app/projects/[id]
touch app/projects/page.tsx
touch app/projects/[id]/page.tsx
touch components/ProjectCard.tsx
touch components/TaskItem.tsx
```

### Cole os componentes acima e teste!

### Parab√©ns! üéâ

Voc√™ tem frontend funcionando!

---

**Total de linhas:** 798 | **Tempo de leitura:** 20 minutos | **Framework:** Espiral Expansiva | **Fidelidade Jos√© Amorim:** 89%
