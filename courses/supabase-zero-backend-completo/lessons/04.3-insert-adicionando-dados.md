# 04.3 - INSERT: Adicionando Dados

**M√≥dulo:** 4 - SQL Essencial com IA
**Dura√ß√£o:** 12 minutos
**Objetivo:** Aprender a adicionar dados sem quebrar o banco
**Bloom Level:** Apply
**Sources:** PostgreSQL INSERT Docs | Supabase Documentation

---

## üéØ O Que Voc√™ Vai Aprender

Ao final desta aula, voc√™ vai saber como:
- ‚úÖ Inserir um registro
- ‚úÖ Inserir m√∫ltiplos registros
- ‚úÖ Usar RETURNING para confirmar
- ‚úÖ Evitar erros comuns

---

## üî• GANCHO EMOCIONAL (Camada 1)

At√© agora voc√™ L√ä dados.

Agora voc√™ vai CRIAR dados novos.

E essa √© a aula em que voc√™ descobre que **√© F√ÅCIL quebrar o banco sem querer**.

Ent√£o voc√™ vai aprender a fazer certo desde o come√ßo.

---

## üè† MET√ÅFORA VISUAL (Camada 2)

Pensa que voc√™ t√° **preenchendo um formul√°rio** no banco.

Tem campos obrigat√≥rios:
- Nome (NOT NULL)
- Email (NOT NULL, UNIQUE)
- Idade (CHECK > 0)

Se voc√™ tenta:
- ‚ùå Deixar nome em branco ‚Üí ERRO (NOT NULL)
- ‚ùå Colocar email que j√° existe ‚Üí ERRO (UNIQUE)
- ‚ùå Colocar idade = -5 ‚Üí ERRO (CHECK)

Mas se tudo t√° certo:
- ‚úÖ Dados entram no banco
- ‚úÖ Banco confirma: "Pronto, ID 101"

---

## üí° FUNDAMENTO CONCEITUAL (Camada 3)

Deixa eu te mostrar INSERT em detalhes...

### Forma B√°sica

```sql
INSERT INTO usuarios (nome, email, idade)
VALUES ('Jo√£o', 'joao@mail.com', 30);
```

**O que significa:**
- INSERT INTO usuarios = Insira na tabela usuarios
- (nome, email, idade) = essas colunas
- VALUES ('Jo√£o', 'joao@mail.com', 30) = com esses valores

---

**Importante: Ordem importa!**

```sql
-- ‚úÖ CERTO
INSERT INTO usuarios (nome, email, idade)
VALUES ('Jo√£o', 'joao@mail.com', 30);

-- ‚ùå ERRADO (n√£o vai funcionar)
INSERT INTO usuarios (nome, email, idade)
VALUES ('joao@mail.com', 'Jo√£o', 30);
-- ‚Üê Colocou email no lugar de nome
```

---

### Inserindo M√∫ltiplos Registros

```sql
INSERT INTO usuarios (nome, email, idade)
VALUES
  ('Jo√£o', 'joao@mail.com', 30),
  ('Maria', 'maria@mail.com', 25),
  ('Pedro', 'pedro@mail.com', 35);
```

**Muito mais r√°pido que 3 INSERT separadas**

---

### Usando RETURNING (PostgreSQL 2025)

```sql
INSERT INTO usuarios (nome, email, idade)
VALUES ('Jo√£o', 'joao@mail.com', 30)
RETURNING id, nome, email;
```

**O que significa:**
- Insira os dados
- E me devolva o ID, nome e email que foi criado

**Resposta:**
```
id | nome | email
---|------|------------------
101| Jo√£o | joao@mail.com
```

**Por que √© √∫til?**
- ‚úÖ Voc√™ descobre o ID criado automaticamente
- ‚úÖ Confirma que dados entrou certo
- ‚úÖ Usa ID na aplica√ß√£o depois

---

### Inserindo com Defaults

```sql
CREATE TABLE posts (
  id SERIAL PRIMARY KEY,
  titulo TEXT,
  status TEXT DEFAULT 'Rascunho',
  criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO posts (titulo)
VALUES ('Meu Primeiro Post');
```

**O que acontece:**
- titulo = 'Meu Primeiro Post'
- status = 'Rascunho' (padr√£o)
- criado_em = AGORA (padr√£o)
- id = gerado automaticamente

---

## ‚ö° APLICA√á√ÉO PR√ÅTICA (Camada 4)

Agora voc√™ vai **INSERIR dados reais**...

### Scenario 1: Um Cliente

**Voc√™ quer adicionar cliente:**
- Nome: Jo√£o
- Email: joao@email.com
- Telefone: 11999999999
- Cidade: S√£o Paulo

```sql
INSERT INTO clientes (nome, email, telefone, cidade)
VALUES ('Jo√£o', 'joao@email.com', '11999999999', 'S√£o Paulo');
```

---

### Scenario 2: M√∫ltiplos Clientes

```sql
INSERT INTO clientes (nome, email, telefone, cidade)
VALUES
  ('Jo√£o', 'joao@email.com', '11999999999', 'S√£o Paulo'),
  ('Maria', 'maria@email.com', '21988888888', 'Rio de Janeiro'),
  ('Pedro', 'pedro@email.com', '47987777777', 'Florian√≥polis');
```

**3 clientes criados de uma vez!**

---

### Scenario 3: Com RETURNING

```sql
INSERT INTO clientes (nome, email, telefone, cidade)
VALUES ('Jo√£o', 'joao@email.com', '11999999999', 'S√£o Paulo')
RETURNING id, nome, email;
```

**Resposta:**
```
id | nome | email
---| -----|------------------
1  | Jo√£o | joao@email.com
```

Agora voc√™ sabe o ID do novo cliente!

---

## üåü EXPANS√ÉO FILOS√ìFICA (Camada 5)

Sabe o erro mais comum?

Inserir dados que violam constraints:

```sql
-- ‚ùå ERRO! Email j√° existe (UNIQUE)
INSERT INTO usuarios (nome, email)
VALUES ('Outro Jo√£o', 'joao@mail.com');

-- ‚ùå ERRO! Nome vazio (NOT NULL)
INSERT INTO usuarios (nome, email)
VALUES (NULL, 'novo@mail.com');

-- ‚ùå ERRO! Idade negativa (CHECK)
INSERT INTO usuarios (nome, email, idade)
VALUES ('Jo√£o', 'joao@mail.com', -5);
```

O banco RECUSA inserir.

E sabe por que?

Porque **voc√™ desenhou essas regras na aula anterior!**

Constraints que voc√™ criou agora te protegem.

Dados ruins nunca entram.

Autom√°tico.

---

E aqui t√° o super poder:

Se voc√™ pedir pro ChatGPT gerar INSERT, voc√™ S√ì copia/cola.

O banco valida tudo pra voc√™.

---

**Processo:**

1. Voc√™: "Quero adicionar usu√°rio com dados X, Y, Z"
2. ChatGPT: Gera INSERT com RETURNING
3. Voc√™: Copia/cola no SQL Editor
4. Banco: Valida e confirma
5. Voc√™: V√™ o resultado com RETURNING

Simples.

---

## ‚úÖ RECAPITULA√á√ÉO (Valida√ß√£o do Aprendizado)

Antes de continuar:

**1. Qual √© a sintaxe b√°sica de INSERT?**
Resposta: INSERT INTO tabela (colunas) VALUES (valores)

**2. Quando usar m√∫ltiplos VALUES?**
Resposta: Quando quer adicionar v√°rios registros de uma vez.

**3. O que RETURNING faz?**
Resposta: Mostra os dados que foi inserido (tipo confirma√ß√£o).

**4. O que acontece se violar um constraint?**
Resposta: Banco retorna ERRO e dados N√ÉO √© inserido.

**5. Voc√™ precisa especificar ID?**
Resposta: N√£o! SERIAL/AUTO-INCREMENT gera automaticamente.

---

## üìù EXERC√çCIO (10 minutos)

**Sua tarefa:**

1. Crie 3 produtos com nome, pre√ßo, estoque
2. Use RETURNING pra confirmar ID
3. Tente inserir um com pre√ßo negativo (vei o erro)

---

## üéØ PR√ìXIMO PASSO

Na pr√≥xima aula (04.4), vamos:
- ‚úÖ UPDATE: Modificar dados existentes
- ‚úÖ WHERE: Qual registro modificar
- ‚úÖ RETURNING: Confirmar mudan√ßa

Bora? üöÄ

---

*Aula criada por Jos√© Amorim (Professor Socr√°tico)*
*Framework: Espiral Expansiva + Anti-Impostor Design*
*Dura√ß√£o estimada: 12 minutos*
*Fonte: PostgreSQL INSERT Docs | Supabase Documentation*
