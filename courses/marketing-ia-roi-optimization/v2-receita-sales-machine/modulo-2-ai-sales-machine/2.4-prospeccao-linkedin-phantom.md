# Aula 2.4: Prospec√ß√£o LinkedIn + Phantom Buster

**M√≥dulo:** 2 - AI Sales Machine
**N√≠vel:** 2 (Funcion√°rio Aprendendo - construir do zero)
**Dura√ß√£o:** 15 minutos
**Ferramentas:** Phantom Buster, LinkedIn Sales Navigator, n8n, PostgreSQL

---

## üéØ Objetivos de Aprendizagem

Ao final desta aula, voc√™ ser√° capaz de:

1. **Configurar Phantom Buster** para extrair leads do LinkedIn automaticamente
2. **Usar LinkedIn Sales Navigator** para criar listas de prospects qualificados
3. **Integrar Phantom ‚Üí n8n ‚Üí PostgreSQL** para armazenar leads
4. **Evitar bloqueio do LinkedIn** com limites di√°rios e aleatoriedade
5. **Extrair 500 leads B2B/m√™s** com alta qualidade (CEOs, Founders, CMOs)

---

## üìä Contexto: Por Que LinkedIn para B2B?

### LinkedIn = Maior Base de B2B do Mundo

**Dados:**
- üåé **930 milh√µes de usu√°rios** (2024)
- üáßüá∑ **63 milh√µes no Brasil**
- üíº **67 milh√µes de empresas** cadastradas
- üéØ **Filtros profissionais:** Cargo, setor, tamanho empresa, localiza√ß√£o, senioridade

### Compara√ß√£o com Outras Fontes

| Fonte | Leads/m√™s | Qualidade | Custo | B2B Fit |
|-------|-----------|-----------|-------|---------|
| **LinkedIn** | 500 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | R$ 299 | üéØ Perfeito |
| Google Maps | 800 | ‚≠ê‚≠ê‚≠ê | R$ 200 | Local/B2C |
| Apollo | 200 | ‚≠ê‚≠ê‚≠ê‚≠ê | R$ 499 | B2B tech |
| Cold scraping | 1000+ | ‚≠ê‚≠ê | R$ 0 | 50% inv√°lido |

**Conclus√£o:** LinkedIn √© **indispens√°vel para B2B SaaS**, ag√™ncias, consultorias.

---

## üèóÔ∏è Estrutura da Aula (15 min)

```
00:00 - 02:00 | Introdu√ß√£o: LinkedIn vs outras fontes
02:00 - 05:00 | Setup Phantom Buster + LinkedIn Sales Navigator
05:00 - 08:00 | Configurar Phantom "Sales Navigator Search Export"
08:00 - 11:00 | Integra√ß√£o n8n: Phantom ‚Üí Database
11:00 - 13:00 | Limites LinkedIn + evitar bloqueio
13:00 - 15:00 | Teste pr√°tico + valida√ß√£o
```

---

## üîß Setup Inicial

### 1. LinkedIn Sales Navigator (Opcional mas Recomendado)

**Por que Sales Navigator?**
- ‚úÖ Filtros avan√ßados (technologies used, funding, hiring)
- ‚úÖ Listas ilimitadas de leads
- ‚úÖ Acesso a InMail (mensagens diretas)
- ‚úÖ Integra√ß√£o melhor com Phantom Buster

**Custo:** R$ 399/m√™s (plano Core)
**Alternativa gratuita:** LinkedIn normal (filtros limitados)

**Como ativar:**
1. Ir para [LinkedIn Sales Navigator](https://www.linkedin.com/sales/)
2. Testar free trial de 30 dias
3. Depois: decidir se vale manter (spoiler: vale para B2B s√©rio)

### 2. Phantom Buster Account

**Plano recomendado:** Starter (R$ 299/m√™s)
- ‚úÖ Execu√ß√µes ilimitadas
- ‚úÖ 20 containers simult√¢neos
- ‚úÖ API access

**Como criar conta:**
1. [phantombuster.com](https://phantombuster.com)
2. Criar conta ‚Üí Escolher plano Starter
3. Conectar conta LinkedIn:
   - Phantom ‚Üí **Settings** ‚Üí **LinkedIn account**
   - Fazer login (Phantom usa sess√£o cookies)

**‚ö†Ô∏è IMPORTANTE:** Use conta LinkedIn separada (n√£o sua pessoal) para evitar bloqueio.

---

## üéØ Configurar Phantom: LinkedIn Sales Navigator Search Export

### Passo 1: Criar Phantom

1. Phantom Buster ‚Üí **Phantoms** ‚Üí **New Phantom**
2. Buscar: **"Sales Navigator Search Export"**
3. Clicar em **Use this Phantom**

### Passo 2: Configurar Search URL

No Sales Navigator, crie uma busca com filtros:

**Exemplo: CEOs de SaaS em S√£o Paulo**

```
Filtros Sales Navigator:
- Geography: Brazil ‚Üí S√£o Paulo
- Job Title: CEO, Founder, Co-Founder
- Industry: Computer Software, Internet, SaaS
- Company Headcount: 11-50, 51-200
- Company Type: Privately Held
```

**URL da busca:**
```
https://www.linkedin.com/sales/search/people?query=(filters%3AList((type%3AREGION%2Cvalues%3AList((id%3A106057199%2Ctext%3AS%C3%A3o%20Paulo)))%2C(type%3ACURRENT_TITLE%2Cvalues%3AList((id%3ACEO)%2C(id%3AFounder)))%2C(type%3AINDUSTRY%2Cvalues%3AList((id%3A4)%2C(id%3A6)))))
```

**Cole essa URL** no campo **"Search URL"** do Phantom.

### Passo 3: Configurar Par√¢metros

```json
{
  "sessionCookie": "{{ sua_sess√£o_linkedin }}",
  "searches": [
    "https://www.linkedin.com/sales/search/people?query=..."
  ],
  "numberOfResultsPerSearch": 100,
  "numberOfLinesPerLaunch": 25,
  "extractDefaultUrl": true,
  "removeDuplicateProfiles": true,
  "saveImg": false,
  "takeScreenshot": false
}
```

**Explica√ß√£o:**
- `numberOfResultsPerSearch: 100` ‚Üí Total de leads que quer extrair dessa busca
- `numberOfLinesPerLaunch: 25` ‚Üí Leads extra√≠dos por execu√ß√£o (para n√£o ser bloqueado)
- `extractDefaultUrl: true` ‚Üí Pega URL do perfil p√∫blico (n√£o Sales Navigator URL)
- `removeDuplicateProfiles: true` ‚Üí Evita duplicatas

### Passo 4: Agendar Execu√ß√µes

**Recomenda√ß√£o:** 1x por dia, 25 leads/dia = 500 leads/m√™s

```json
{
  "schedule": {
    "type": "daily",
    "time": "10:00",
    "timezone": "America/Sao_Paulo"
  }
}
```

**Por que n√£o executar tudo de uma vez (100 leads)?**
- ‚ùå LinkedIn detecta automa√ß√£o e pode bloquear
- ‚úÖ 25 leads/dia = comportamento "humano"
- ‚úÖ 25 √ó 20 dias √∫teis = 500 leads/m√™s

---

## üîó Integra√ß√£o n8n: Phantom ‚Üí Database

### Flow Completo

```
[Phantom Buster executa diariamente] ‚Üí [Phantom Webhook ‚Üí n8n] ‚Üí
[Formatar dados] ‚Üí [Enriquecer com Apollo] ‚Üí [Insert PostgreSQL]
```

### n8n Workflow

**Trigger: Phantom Buster Webhook**

```json
{
  "nodes": [
    {
      "name": "Phantom Webhook",
      "type": "n8n-nodes-base.webhook",
      "parameters": {
        "path": "phantom-linkedin",
        "httpMethod": "POST",
        "responseMode": "onReceived"
      }
    }
  ]
}
```

**Configurar Webhook no Phantom:**
1. Phantom ‚Üí **Settings** ‚Üí **Webhooks**
2. **Add Webhook URL:** `https://seu-n8n.com/webhook/phantom-linkedin`
3. **Trigger:** On execution finished
4. **Payload:** Send full result

**Processar Dados do Phantom**

```json
{
  "name": "Extract Lead Data",
  "type": "n8n-nodes-base.function",
  "parameters": {
    "functionCode": "const items = $input.all();\nconst phantomResults = items[0].json.resultObject;\n\nreturn phantomResults.map(lead => ({\n  json: {\n    // Basic info\n    name: lead.firstName + ' ' + lead.lastName,\n    email: lead.email || null,\n    linkedin_url: lead.profileUrl,\n    \n    // Professional info\n    job_title: lead.title,\n    company: lead.companyName,\n    company_size: lead.companyHeadcount,\n    industry: lead.industry,\n    location: lead.location,\n    \n    // Source tracking\n    source: 'linkedin',\n    source_id: lead.profileUrl,\n    \n    // Metadata\n    profile_picture: lead.imgUrl,\n    summary: lead.headline\n  }\n}));"
  }
}
```

**Enriquecer com Apollo (se email n√£o existir)**

```json
{
  "name": "Find Email - Apollo",
  "type": "n8n-nodes-base.httpRequest",
  "parameters": {
    "url": "https://api.apollo.io/v1/people/match",
    "method": "POST",
    "authentication": "headerAuth",
    "headerParameters": {
      "parameters": [
        { "name": "X-Api-Key", "value": "={{ $env.APOLLO_API_KEY }}" }
      ]
    },
    "bodyParameters": {
      "parameters": [
        { "name": "first_name", "value": "={{ $json.name.split(' ')[0] }}" },
        { "name": "last_name", "value": "={{ $json.name.split(' ').slice(1).join(' ') }}" },
        { "name": "organization_name", "value": "={{ $json.company }}" }
      ]
    },
    "options": {
      "ignoreResponseCode": true
    }
  }
}
```

**Merge Apollo + Phantom Data**

```json
{
  "name": "Merge Data",
  "type": "n8n-nodes-base.function",
  "parameters": {
    "functionCode": "const phantomData = $input.first().json;\nconst apolloData = $input.last().json;\n\nreturn {\n  json: {\n    ...phantomData,\n    email: apolloData.person?.email || phantomData.email || null,\n    phone: apolloData.person?.phone_numbers?.[0]?.sanitized_number || null,\n    enrichment_data: apolloData.person || null\n  }\n};"
  }
}
```

**Insert PostgreSQL**

```json
{
  "name": "Insert to Database",
  "type": "n8n-nodes-base.postgres",
  "parameters": {
    "operation": "insert",
    "table": "leads",
    "columns": "name, email, linkedin_url, job_title, company, company_size, industry, location, source, source_id, enrichment_data",
    "options": {
      "onConflict": "DO NOTHING"
    },
    "returnFields": "*"
  }
}
```

**Update Lead Score** (pr√≥xima aula veremos em detalhes)

```json
{
  "name": "Calculate Lead Score",
  "type": "@n8n/n8n-nodes-langchain.openAi",
  "parameters": {
    "model": "gpt-4",
    "messages": {
      "values": [
        {
          "content": "Score this B2B lead 0-100:\n\nTitle: {{ $json.job_title }}\nCompany: {{ $json.company }}\nSize: {{ $json.company_size }}\nIndustry: {{ $json.industry }}\n\nScoring criteria:\n- Decision maker (CEO/Founder): +40\n- Target industry (SaaS/Tech): +30\n- Company size 50-200: +20\n- Location S√£o Paulo: +10\n\nOutput JSON only: { \"lead_score\": 85, \"reasoning\": \"...\" }"
        }
      ]
    }
  }
}
```

---

## ‚ö†Ô∏è Limites do LinkedIn (Evitar Bloqueio)

### Limites Di√°rios Seguros

| A√ß√£o | Limite Di√°rio Seguro | Limite Mensal |
|------|---------------------|---------------|
| **Profile views** | 80-100/dia | ~2.000/m√™s |
| **Connection requests** | 20-30/dia | 400-600/m√™s |
| **Messages (InMail)** | 50/dia | 1.000/m√™s |
| **Search results scraping** | 100/dia | 2.000/m√™s |

**Se ultrapassar:** LinkedIn pode:
1. Mostrar CAPTCHA
2. Limitar a√ß√µes temporariamente (24-48h)
3. Suspender conta (caso grave)

### Como Evitar Bloqueio

**1. Aleatoriedade de timing**

Em vez de executar sempre √†s 10:00 AM:

```json
{
  "schedule": {
    "type": "daily",
    "randomStartMinute": true,
    "timeWindow": {
      "start": "09:00",
      "end": "11:00"
    }
  }
}
```

Phantom vai executar entre 9-11 AM aleatoriamente.

**2. Delays entre a√ß√µes**

```json
{
  "actionDelay": {
    "min": 2000,
    "max": 5000
  }
}
```

Phantom vai esperar 2-5 segundos aleat√≥rios entre cada profile view.

**3. Use conta LinkedIn "burner"**

**N√ÉO** use sua conta pessoal principal. Crie:
- Email novo (Gmail: `empresa-automation@gmail.com`)
- Perfil LinkedIn completo (foto, experi√™ncia, 500+ conex√µes)
- Atividade "humana" (curtir posts, comentar 1-2x/semana)

**4. Warm-up da conta**

Primeiros 7 dias:
- Dia 1-2: S√≥ login, navegar manualmente
- Dia 3-4: 10 profile views/dia manualmente
- Dia 5-7: 20 profile views/dia com Phantom
- Dia 8+: 25 profile views/dia (full automation)

---

## üß™ Teste Pr√°tico

### Valida√ß√£o Step-by-Step

**1. Testar Phantom Manualmente**

```bash
# No Phantom Buster dashboard
1. Clicar em "Launch" no Phantom configurado
2. Esperar ~2-3 minutos
3. Ver resultado: 25 leads extra√≠dos?
4. Download CSV para verificar qualidade
```

**Validar CSV:**
- Todos t√™m nome? ‚úÖ
- Todos t√™m job title? ‚úÖ
- Todos t√™m empresa? ‚úÖ
- Linkedin URL v√°lida? ‚úÖ

**2. Testar Webhook n8n**

```bash
# Trigger webhook manualmente
curl -X POST https://seu-n8n.com/webhook/phantom-linkedin \
  -H "Content-Type: application/json" \
  -d '{
    "resultObject": [
      {
        "firstName": "Jo√£o",
        "lastName": "Silva",
        "title": "CEO",
        "companyName": "TechCorp",
        "profileUrl": "https://linkedin.com/in/joaosilva"
      }
    ]
  }'
```

**Verificar:**
- n8n recebeu webhook? ‚úÖ
- Lead foi inserido no PostgreSQL? ‚úÖ
- Email foi enriquecido via Apollo? ‚úÖ

**3. Validar Database**

```sql
SELECT
  COUNT(*) as total_leads,
  COUNT(email) as with_email,
  AVG(lead_score) as avg_score,
  source
FROM leads
WHERE source = 'linkedin'
GROUP BY source;
```

**Resultado esperado:**
```
total_leads | with_email | avg_score | source
------------|------------|-----------|--------
     25     |     18     |    78     | linkedin
```

**Taxa de email encontrado:** 70-75% √© normal (Apollo n√£o acha todos).

---

## üéØ Otimiza√ß√µes Avan√ßadas

### 1. M√∫ltiplas Searches (Segmenta√ß√£o)

Em vez de 1 search gen√©rica, crie 3-5 searches espec√≠ficas:

**Search 1: SaaS CEOs (100 leads)**
```
Title: CEO, Founder
Industry: SaaS, Software
Size: 50-200
```

**Search 2: Marketing CMOs (100 leads)**
```
Title: CMO, VP Marketing
Industry: Tech, Internet
Size: 200-1000
```

**Search 3: Ag√™ncias Founders (100 leads)**
```
Title: Founder, Owner
Industry: Marketing, Advertising
Size: 11-50
```

**Vantagem:** Leads mais segmentados = messaging mais personalizado.

### 2. Enriquecer com Dados de Atividade

Phantom pode extrair **posts recentes** do lead:

```json
{
  "extractRecentActivity": true,
  "numberOfPosts": 3
}
```

**Use no GPT-4 personalization:**
```
Lead posted recently about: "{{ $json.recentPost1 }}"

Write email mentioning this post.
```

### 3. Export para Google Sheets (Backup)

Al√©m do PostgreSQL, salve em Google Sheets para an√°lise manual:

```json
{
  "name": "Append to Google Sheets",
  "type": "n8n-nodes-base.googleSheets",
  "parameters": {
    "operation": "append",
    "sheetId": "{{ $env.GOOGLE_SHEET_ID }}",
    "range": "A:Z"
  }
}
```

---

## ‚úÖ Entreg√°vel Pr√°tico

Ao final desta aula, voc√™ ter√°:

```
phantom-buster/
‚îú‚îÄ‚îÄ linkedin-sales-nav-search.json    (config Phantom)
‚îî‚îÄ‚îÄ search-urls.txt                   (suas 3-5 searches)

n8n-workflows/
‚îî‚îÄ‚îÄ phantom-linkedin-to-db.json       (workflow completo)

database/
‚îî‚îÄ‚îÄ leads table populated             (25-500 leads LinkedIn)
```

---

## üéØ Checklist de Valida√ß√£o

Antes de prosseguir, valide:

- [ ] **Phantom Buster conta criada** e LinkedIn conectado
- [ ] **Sales Navigator search configurado** com filtros corretos
- [ ] **Phantom extraindo 25 leads/dia** sem erros
- [ ] **Webhook n8n recebendo** dados do Phantom
- [ ] **Apollo enriquecendo emails** (70%+ taxa)
- [ ] **PostgreSQL armazenando leads** com `source = 'linkedin'`
- [ ] **Nenhum bloqueio LinkedIn** (conta ativa sem CAPTCHA)
- [ ] **Teste end-to-end:** 25 leads extra√≠dos ‚Üí 18 com email ‚Üí inseridos no DB

---

## üöÄ Pr√≥ximos Passos

Agora que tem LinkedIn funcionando:

1. **Aula 2.5** ‚Üí Apollo Search & Enrich (buscar leads direto no Apollo database)
2. **Aula 2.6** ‚Üí Lead Scoring Inteligente (GPT-4 advanced scoring com m√∫ltiplos fatores)
3. **Aula 2.7** ‚Üí Sequ√™ncias Multi-Canal (combinar LinkedIn + Email + WhatsApp)

---

## üìö Recursos Adicionais

- [Phantom Buster LinkedIn Phantoms](https://phantombuster.com/phantombuster?category=linkedin)
- [LinkedIn Automation Best Practices](https://phantombuster.com/blog/linkedin-automation-best-practices)
- [Sales Navigator vs LinkedIn Free](https://business.linkedin.com/sales-solutions/compare-plans)
- [Apollo + Phantom Integration Guide](https://www.apollo.io/integrations)

---

**üéì Conceito-chave:** LinkedIn √© a melhor fonte para B2B, mas precisa de limites di√°rios para evitar bloqueio. Use Phantom Buster com modera√ß√£o (25 leads/dia) e sempre enrique√ßa com Apollo para encontrar emails.
