# 02.4 - Conectando Tabelas na PrÃ¡tica

**MÃ³dulo:** 2 - Modelagem Sem Drama
**DuraÃ§Ã£o:** 14 minutos
**Objetivo:** Criar 2 tabelas conectadas no Supabase
**Bloom Level:** Apply

---

## ğŸ¯ O Que VocÃª Vai Aprender

Ao final desta aula, vocÃª vai saber como:
- âœ… Criar Tabela 1 com Chave PrimÃ¡ria
- âœ… Criar Tabela 2 que referencia Tabela 1
- âœ… Testar o relacionamento funcionando
- âœ… Fazer consultas usando FK

---

## ğŸ”¥ GANCHO EMOCIONAL (Camada 1)

AtÃ© agora vocÃª entendeu a TEORIA.

NormalizaÃ§Ã£o? Entendi.
Chave PrimÃ¡ria? Entendi.
Chave Estrangeira? Entendi.

Mas sabe aquele frio na espinha de "serÃ¡ que eu consigo criar isso?"

**Vou te provar que consegue.**

Vamos criar um banco de dados REAL, funcional, em 14 minutos.

Sem cÃ³digo.
SÃ³ clicando no Supabase.

E no final vocÃª vai pensar: "caramba, era sÃ³ isso?"

---

## ğŸ“Š METÃFORA VISUAL (Camada 2)

A gente vai criar um app de **Reserva de Salas de ReuniÃ£o** (tipo Workplace by Meta, mas simples).

**O que vocÃª vai criar:**

Tabela 1: **Salas** (espaÃ§os fÃ­sicos)
| ID | Nome | Capacidade |
|----|------|------------|
| 1 | Sala A | 10 |
| 2 | Sala B | 20 |

Tabela 2: **Reservas** (agendamentos)
| ID | sala_id | Data | Hora_inicio |
|----|---------|------|-------------|
| 1 | 1 | 01/01 | 10:00 |
| 2 | 2 | 01/01 | 14:00 |
| 3 | 1 | 02/01 | 15:00 |

Quando vocÃª vÃª "sala_id = 1", vocÃª automaticamente sabe que Ã© a "Sala A".

---

## ğŸ’¡ FUNDAMENTO CONCEITUAL (Camada 3)

Deixa eu te mostrar EXATAMENTE o que vocÃª vai fazer em 5 passos...

### Os 5 Passos da PrÃ¡tica

**Passo 1: Criar Tabela de Salas**
```
Tabela: salas
Colunas:
- id (BIGINT, Primary Key, Auto-increment)
- nome (TEXT)
- capacidade (INTEGER)
```

**Passo 2: Criar Tabela de Reservas**
```
Tabela: reservas
Colunas:
- id (BIGINT, Primary Key, Auto-increment)
- sala_id (BIGINT, Foreign Key â†’ salas.id)
- data_reserva (DATE)
- hora_inicio (TIME)
```

**Passo 3: Inserir Dados em Salas**
```
INSERT INTO salas (nome, capacidade) VALUES
('Sala A', 10),
('Sala B', 20);
```

**Passo 4: Inserir Dados em Reservas**
```
INSERT INTO reservas (sala_id, data_reserva, hora_inicio) VALUES
(1, '2024-01-01', '10:00'),
(2, '2024-01-01', '14:00'),
(1, '2024-01-02', '15:00');
```

**Passo 5: Fazer Consulta com JOIN**
```
SELECT r.id, s.nome, r.data_reserva, r.hora_inicio
FROM reservas r
JOIN salas s ON r.sala_id = s.id;
```

**Resultado:**
```
| ID | nome   | data_reserva | hora_inicio |
|----|--------|--------------|-------------|
| 1  | Sala A | 2024-01-01   | 10:00       |
| 2  | Sala B | 2024-01-01   | 14:00       |
| 3  | Sala A | 2024-01-02   | 15:00       |
```

---

## âš¡ APLICAÃ‡ÃƒO PRÃTICA (Camada 4)

Agora vocÃª VA FAZER isso NO SUPABASE.

### Passo 1: Criar Tabela "Salas"

**No Supabase Dashboard:**

1. Clique em "Create a new table"
2. Nome da tabela: `salas`
3. Clique em "Create"
4. Supabase cria automaticamente a coluna `id` (Primary Key)
5. Clique em "+" para adicionar colunas:
   - **nome** (text)
   - **capacidade** (int8)
6. Clique em "Save"

Pronto! Primeira tabela criada.

---

### Passo 2: Criar Tabela "Reservas"

1. Clique em "Create a new table"
2. Nome: `reservas`
3. Clique em "Create"
4. Adicione colunas com "+" :
   - **sala_id** (int8) â† IMPORTANTE: este Ã© o campo que vai conectar
   - **data_reserva** (date)
   - **hora_inicio** (time)
5. Agora vamos **transformar sala_id em Foreign Key**:
   - Clique em `sala_id`
   - VÃ¡ em "Constraints"
   - Adicione "Foreign Key" â†’ Referencia tabela `salas`, coluna `id`
6. Clique em "Save"

**Pronto! Tabelas conectadas.**

---

### Passo 3: Inserir Dados (UI Visual)

Agora vamos testar se tÃ¡ funcionando...

**Inserir em Salas:**

1. VÃ¡ na tabela `salas`
2. Clique no "+" para adicionar linha
3. Preencha:
   - nome: "Sala A"
   - capacidade: 10
4. Salve
5. Adicione outra linha:
   - nome: "Sala B"
   - capacidade: 20

Resultado:
```
| ID | nome   | capacidade |
|----|--------|------------|
| 1  | Sala A | 10         |
| 2  | Sala B | 20         |
```

---

**Inserir em Reservas:**

1. VÃ¡ na tabela `reservas`
2. Clique no "+" para adicionar linha
3. Preencha:
   - sala_id: 1 (aparece dropdown automaticamente com "Sala A")
   - data_reserva: 2024-01-01
   - hora_inicio: 10:00
4. Salve
5. Adicione mais:
   - sala_id: 2, data: 2024-01-01, hora: 14:00
   - sala_id: 1, data: 2024-01-02, hora: 15:00

Resultado:
```
| ID | sala_id | data_reserva | hora_inicio |
|----|---------|--------------|-------------|
| 1  | 1       | 2024-01-01   | 10:00       |
| 2  | 2       | 2024-01-01   | 14:00       |
| 3  | 1       | 2024-01-02   | 15:00       |
```

---

### Passo 4: Validar o Relacionamento

Agora vamos PROVAR que as tabelas estÃ£o conectadas.

**Teste 1: Clique em uma Reserva**

1. VÃ¡ na tabela `reservas`
2. Clique na linha com sala_id=1
3. Repare que aparece "Sala A" em um dropdown

âœ… Prova que ela tÃ¡ conectada!

---

**Teste 2: FaÃ§a uma Consulta (Query)**

Se vocÃª quer ver o NOME da sala dentro de Reservas (nÃ£o sÃ³ o ID):

1. VÃ¡ em "SQL Editor"
2. Cole isso:
```sql
SELECT
  r.id,
  s.nome as sala,
  r.data_reserva,
  r.hora_inicio
FROM reservas r
JOIN salas s ON r.sala_id = s.id;
```

3. Clique em "Run"

**Resultado:**
```
| id | sala   | data_reserva | hora_inicio |
|----|--------|--------------|-------------|
| 1  | Sala A | 2024-01-01   | 10:00       |
| 2  | Sala B | 2024-01-01   | 14:00       |
| 3  | Sala A | 2024-01-02   | 15:00       |
```

âœ… PRONTA A PROVA! VocÃª conectou duas tabelas!

---

## ğŸŒŸ EXPANSÃƒO FILOSÃ“FICA (Camada 5)

Repara naquela query que vocÃª acabou de rodar?

```sql
SELECT ... FROM reservas r
JOIN salas s ON r.sala_id = s.id;
```

Essa Ã© a MAGIA do banco de dados relacional.

VocÃª tem dois "universos" separados:
- Universo 1: Salas (o que existe fisicamente)
- Universo 2: Reservas (quem quer usar o quÃª)

E vocÃª consegue **unir** esses universos com um simples `JOIN`.

---

E sabe o que Ã© mais legal?

VocÃª consegue fazer QUALQUER pergunta:

- "Quais salas tÃªm reservas no dia 01/01?" â†’ JOIN
- "Qual Ã© a sala com mais reservas?" â†’ COUNT + GROUP BY
- "Quanto tempo cada sala tÃ¡ reservada?" â†’ Data math
- "Quando fica liberado pra reservar de novo?" â†’ LÃ³gica

Tudo com dados bem ORGANIZADOS.

---

Se vocÃª tivesse feito tudo em UMA tabela bagunÃ§ada, seria um INFERNO responder essas perguntas.

Aqui, Ã© elegante.

Ã‰ simples.

Ã‰ bonito.

---

## âœ… RECAPITULAÃ‡ÃƒO (ValidaÃ§Ã£o do Aprendizado)

VocÃª fez MUITO nesta aula. Me responde:

**1. O que Ã© um relacionamento entre tabelas?**
Resposta: Uma tabela aponta pra outra via Foreign Key.

**2. Como vocÃª criou a Foreign Key?**
Resposta: Na coluna sala_id, adicionei uma constraint que referencia salas.id.

**3. O que provou que funcionou?**
Resposta: O dropdown em sala_id e a query JOIN funcionaram.

**4. Por que isso Ã© importante?**
Resposta: Porque permite consultas poderosas e dados bem organizados.

---

## ğŸ“ EXERCÃCIO (10 minutos)

Agora Ã© tua vez de criar um relacionamento NOVO.

**Sua tarefa:**

Crie um banco de dados de **Eventos + Participantes**:

1. Tabela `eventos` com:
   - id (PK)
   - nome
   - data_evento

2. Tabela `participantes` com:
   - id (PK)
   - evento_id (FK â†’ eventos.id)
   - nome_participante
   - email

3. Insira dados:
   - Evento 1: "Workshop IA" em 15/01
   - Evento 2: "Python 101" em 20/01
   - 3-4 participantes em cada evento

4. Rode uma query para ver nome do evento + nome do participante

**Dica:** Usa o mesmo processo da aula (criar tabelas â†’ FK â†’ inserir dados â†’ query).

Quando terminar, manda resultado e vamos pra prÃ³xima aula!

---

## ğŸ¯ PRÃ“XIMO PASSO

VocÃª acabou de completar o **MÃ³dulo 2: Modelagem Sem Drama**!

VocÃª:
- âœ… Entendeu normalizaÃ§Ã£o
- âœ… Aprendeu PK e FK
- âœ… Criou tabelas conectadas
- âœ… Fez queries com JOIN

PrÃ³ximo Ã© **MÃ³dulo 3: Criando Tabelas de Verdade** onde vocÃª vai:
- âœ… Tipos de dados (string, nÃºmero, data)
- âœ… Constraints (regras que protegem)
- âœ… CASCADE (o que acontece quando deleta)

Bora? ğŸš€

---

*Aula criada por JosÃ© Amorim (Professor SocrÃ¡tico)*
*Framework: Espiral Expansiva + Anti-Impostor Design*
*DuraÃ§Ã£o estimada: 14 minutos (+ 10 min exercÃ­cio)*
