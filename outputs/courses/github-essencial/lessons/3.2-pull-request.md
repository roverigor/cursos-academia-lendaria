# 3.2 - Pull Request

**Dura√ß√£o:** 15 min | **N√≠vel:** Iniciante

## Objetivo

Criar Pull Requests (PRs) profissionais, escrever descri√ß√µes claras e entender o fluxo de aprova√ß√£o usado em empresas.

## Por que isso importa

Pull Request √© como voc√™ contribui em projetos reais. √â onde acontece colabora√ß√£o, discuss√£o t√©cnica e garantia de qualidade. Recrutadores avaliam sua capacidade de comunica√ß√£o t√©cnica olhando seus PRs. Um PR bem escrito mostra profissionalismo.

## Conte√∫do

### O Que √â Pull Request?

**Pull Request (PR):** Proposta de mudan√ßa no c√≥digo.

**Fluxo:**
```
Voc√™: "Aqui est√° minha feature, por favor revise e integre"
   ‚Üì
Time: Revisa c√≥digo, comenta, sugere melhorias
   ‚Üì
Voc√™: Ajusta baseado no feedback
   ‚Üì
Time: Aprova
   ‚Üì
Merge: C√≥digo integrado ao main
```

**Nome confuso?** Deveria chamar "Merge Request" (GitLab usa esse nome). Voc√™ est√° **pedindo** que fa√ßam **pull** (integrem) suas mudan√ßas.

### Quando Criar Pull Request

**Sempre que:**
- Completou uma feature
- Corrigiu um bug
- Atualizou documenta√ß√£o
- Qualquer mudan√ßa que vai para `main`

**Regra de ouro:** Nada entra em `main` sem PR e aprova√ß√£o.

### Anatomia de um PR Profissional

```markdown
## üìù Descri√ß√£o

Implementa autentica√ß√£o de usu√°rio com JWT tokens.
Permite login/logout seguro e prote√ß√£o de rotas.

## üéØ Motiva√ß√£o

Closes #42 - Usu√°rios n√£o tinham como acessar funcionalidades privadas.

## ‚ú® Mudan√ßas

- Adiciona endpoint POST /api/login
- Implementa gera√ß√£o de JWT token
- Cria middleware de autentica√ß√£o
- Adiciona testes de autentica√ß√£o

## üß™ Como Testar

1. Clone a branch: `git checkout feature/user-auth`
2. Rode: `npm install && npm start`
3. Teste login: `curl -X POST localhost:3000/api/login -d '{"email":"test@example.com","password":"test123"}'`
4. Verifique que retorna token JWT

## üì∏ Screenshots (se UI)

[Screenshot do formul√°rio de login]

## ‚úÖ Checklist

- [x] C√≥digo segue style guide do projeto
- [x] Todos os testes passam
- [x] Adicionei testes para novas funcionalidades
- [x] Documenta√ß√£o atualizada
- [x] Sem breaking changes
```

### Criando Pull Request no GitHub

#### Passo 1: Push da Branch

```bash
# Certifique que commitou tudo
git status

# Push para GitHub
git push -u origin feature/user-auth
```

#### Passo 2: Abrir PR no GitHub

**M√©todo 1 - Banner autom√°tico:**

Ap√≥s push, GitHub mostra banner amarelo:
```
feature/user-auth had recent pushes
[Compare & pull request]
```

Clique no bot√£o.

**M√©todo 2 - Manual:**

1. V√° no reposit√≥rio no GitHub
2. Clique em "Pull requests"
3. Clique "New pull request"
4. Compare: `base: main` ‚Üê `compare: feature/user-auth`
5. Clique "Create pull request"

#### Passo 3: Preencher Informa√ß√µes

**T√≠tulo:**
- Claro e espec√≠fico
- Formato: `[type] Description`
- Exemplo: `[Feature] Add user authentication with JWT`

**Descri√ß√£o:**
Use template acima. Principais se√ß√µes:

1. **O qu√™:** Resumo da mudan√ßa
2. **Por qu√™:** Problema resolvido
3. **Como:** Lista de mudan√ßas
4. **Testar:** Passos para revisor validar
5. **Checklist:** Garantir qualidade

**Reviewers:**
- Selecione quem deve revisar (colegas de time)
- Em projetos pessoais/estudos: deixe vazio

**Labels:**
- `enhancement` - Nova feature
- `bug` - Corre√ß√£o
- `documentation` - Docs
- `good first issue` - Bom para iniciantes

**Milestone/Project:** (opcional)
- Vincula a sprint ou milestone espec√≠fico

#### Passo 4: Create Pull Request

Clique no bot√£o verde "Create pull request".

### Tipos de Pull Request

#### 1. Feature PR

```markdown
## [Feature] Add dark mode toggle

Implementa altern√¢ncia entre tema claro e escuro.

**Closes #23**

### Changes
- Add theme context provider
- Implement dark mode styles
- Add toggle button in navbar

### Testing
Toggle button works, styles switch correctly.
```

#### 2. Bug Fix PR

```markdown
## [Fix] Resolve navbar overflow on mobile

Navbar estava quebrando layout em telas < 768px.

**Fixes #56**

### Changes
- Add media query for mobile
- Fix flexbox alignment

### Testing
Tested on iPhone 12, Pixel 5 - works correctly.
```

#### 3. Documentation PR

```markdown
## [Docs] Update installation instructions

Instru√ß√µes estavam desatualizadas (Node 14 ‚Üí 18).

### Changes
- Update Node version requirement
- Add troubleshooting section
- Fix broken links
```

#### 4. Refactor PR

```markdown
## [Refactor] Extract validation logic to utils

C√≥digo de valida√ß√£o estava duplicado em 5 arquivos.

### Changes
- Create utils/validation.js
- Replace inline validation with utils
- Add unit tests for validation

### Impact
- No breaking changes
- Same behavior, cleaner code
- Easier to maintain
```

### Draft Pull Request

**Use quando:** PR n√£o est√° pronto para review, mas quer mostrar progresso.

```
[Create pull request ‚ñº]
  ‚îî‚îÄ Create draft pull request
```

**Caracter√≠sticas:**
- Marcado como "Draft"
- N√£o pode fazer merge
- Reviewers sabem que n√£o est√° pronto
- Converte para PR normal quando pronto: "Ready for review"

**Quando usar:**
- Trabalho em progresso (WIP)
- Quer feedback antecipado
- Trabalho de v√°rios dias, quer visibilidade

### Linkando Issues

**Palavras-chave que fecham issues automaticamente:**

```markdown
Closes #123
Fixes #456
Resolves #789
```

Quando PR for merged, issues s√£o fechadas automaticamente.

**M√∫ltiplas issues:**
```markdown
Closes #123, #124, #125
```

**Apenas referenciar (sem fechar):**
```markdown
Related to #123
See #456
Part of #789
```

### Template de Pull Request

**Crie arquivo:** `.github/pull_request_template.md`

```markdown
## Descri√ß√£o

Descreva suas mudan√ßas aqui.

## Tipo de Mudan√ßa

- [ ] Bug fix
- [ ] Nova feature
- [ ] Breaking change
- [ ] Documenta√ß√£o

## Como Foi Testado?

Descreva os testes realizados.

## Checklist

- [ ] Meu c√≥digo segue o style guide
- [ ] Fiz self-review do c√≥digo
- [ ] Comentei c√≥digo complexo
- [ ] Atualizei documenta√ß√£o
- [ ] Minhas mudan√ßas n√£o geram warnings
- [ ] Adicionei testes
- [ ] Testes novos e existentes passam
```

Toda vez que abrir PR, esse template aparece automaticamente.

### Fluxo de Revis√£o

```
1. Criar PR
   ‚Üì
2. Automatic checks (se configurado)
   - Testes rodam automaticamente
   - Linting verifica style
   - Build √© testado
   ‚Üì
3. Code Review
   - Reviewers comentam
   - Sugerem mudan√ßas
   - Aprovam ou solicitam altera√ß√µes
   ‚Üì
4. Voc√™ responde feedback
   - Faz commits adicionais
   - Responde coment√°rios
   - Marca conversas como resolvidas
   ‚Üì
5. Aprova√ß√£o
   - Reviewer aprova PR
   - Checks passam (verde ‚úì)
   ‚Üì
6. Merge
   - C√≥digo integrado ao main
   - Branch pode ser deletada
```

### Atualizando PR com Novos Commits

PR n√£o √© est√°tico. Voc√™ pode continuar commitando:

```bash
# PR j√° existe para feature/user-auth
git checkout feature/user-auth

# Fazer mudan√ßas baseadas em review
# ... editar arquivos ...

git add .
git commit -m "Address review feedback: improve error handling"

# Push automaticamente atualiza PR
git push
```

PR √© atualizado em tempo real com novos commits.

### Merge Strategies

Quando PR √© aprovado, escolha como fazer merge:

#### 1. Merge Commit (padr√£o)

```
main:     A---B-------M
               \     /
feature:        C---D
```

**Quando usar:** Quer preservar hist√≥rico completo da branch.

#### 2. Squash and Merge

```
main:     A---B---C'
               \
feature:        C---D---E (squashed em C')
```

Todos commits da branch viram 1 commit em main.

**Quando usar:** Branch tem muitos commits pequenos/WIP.

**Vantagem:** Hist√≥rico de main limpo.

#### 3. Rebase and Merge

```
main:     A---B---C---D
```

Commits s√£o replicados diretamente em main (linear).

**Quando usar:** Commits j√° est√£o bem organizados.

**Vantagem:** Hist√≥rico perfeitamente linear.

**Recomenda√ß√£o:** Use **Squash and Merge** para come√ßar (mais simples).

### Deletando Branch Ap√≥s Merge

```bash
# GitHub oferece bot√£o "Delete branch" ap√≥s merge
# Ou manual:

# Deletar remote
git push origin --delete feature/user-auth

# Deletar local
git checkout main
git pull  # Atualiza main com merge
git branch -d feature/user-auth
```

### PR em Projeto Open Source

**Diferen√ßas:**
1. **Fork primeiro:** Clone do projeto para sua conta
2. **Branch no seu fork:** Trabalhe l√°
3. **PR do fork para original:** Compare across forks
4. **Paci√™ncia:** Mantenedores podem demorar para revisar

**Exemplo:**
```bash
# 1. Fork github.com/facebook/react no navegador
# 2. Clone seu fork
git clone git@github.com:SEU-USER/react.git

# 3. Crie branch
git checkout -b fix/typo-in-docs

# 4. Fa√ßa mudan√ßas, commit, push
git push -u origin fix/typo-in-docs

# 5. No GitHub, abra PR do seu fork para facebook/react
```

### Boas Pr√°ticas de Pull Request

**‚úÖ Fa√ßa:**
- PRs pequenos (max 400 linhas mudadas)
- Um prop√≥sito por PR
- Descri√ß√£o detalhada
- Auto-review antes de pedir review
- Responder feedback rapidamente
- Agradecer reviewers

**‚ùå Evite:**
- PRs gigantes (1000+ linhas)
- M√∫ltiplas features em um PR
- Descri√ß√£o vaga: "Fixed stuff"
- Commits quebrados (cada commit deve funcionar)
- Ignorar feedback
- Levar para o pessoal

## Exerc√≠cio Pr√°tico

Use branch `feature/add-greeting` do exerc√≠cio anterior:

```bash
# 1. Certifique que branch foi pushed
git checkout feature/add-greeting
git push -u origin feature/add-greeting

# 2. V√° para GitHub
# github.com/seu-usuario/github-practice-repo

# 3. Veja banner ou clique "Pull requests" ‚Üí "New"

# 4. Preencha PR:
```

**T√≠tulo:**
```
[Feature] Add greeting function
```

**Descri√ß√£o:**
```markdown
## Descri√ß√£o

Adiciona fun√ß√£o de sauda√ß√£o reutiliz√°vel.

## Mudan√ßas

- Cria `greeting.js` com fun√ß√£o `greet(name)`
- Retorna sauda√ß√£o personalizada

## Como Testar

```bash
git checkout feature/add-greeting
node -e "const {greet} = require('./greeting'); console.log(greet('World'));"
# Deve mostrar: Hello, World!
```

## Checklist

- [x] C√≥digo funciona
- [x] Nome de fun√ß√£o √© descritivo
```

```bash
# 5. Create pull request

# 6. Na p√°gina do PR:
#    - Veja "Files changed" (diff do c√≥digo)
#    - Veja "Commits" (hist√≥rico da branch)

# 7. Simule aprova√ß√£o (em projeto real, outro dev aprovaria)
#    - Clique "Merge pull request"
#    - Confirme merge
#    - Delete branch

# 8. De volta ao terminal
git checkout main
git pull  # Atualiza com merge

# 9. Veja que arquivo agora existe em main
ls greeting.js
# greeting.js (agora est√° em main!)

# 10. Veja hist√≥rico
git log --oneline
# Deve incluir seu merge
```

## Checkpoint

- [ ] Sei criar Pull Request no GitHub
- [ ] Escrevo descri√ß√µes claras (o qu√™, por qu√™, como)
- [ ] Uso template com checklist
- [ ] Linko issues relacionadas (Closes #123)
- [ ] Entendo fluxo: PR ‚Üí Review ‚Üí Ajustes ‚Üí Aprova√ß√£o ‚Üí Merge
- [ ] Sei fazer merge e deletar branch
- [ ] PRs pequenos e focados

## Pr√≥xima li√ß√£o

Voc√™ criou PR! Agora vamos aprender o outro lado: como revisar PRs de colegas profissionalmente. ‚Üí **3.3 - Code Review**
