# 2.5 - .gitignore essencial

**Duração:** 5 min | **Nível:** Iniciante

## Objetivo

Configurar .gitignore corretamente para nunca versionar arquivos sensíveis, temporários ou gerados automaticamente.

## Por que isso importa

Commitar `node_modules/` com 100MB de dependências é erro de iniciante. Pior: commitar `.env` com senhas é brecha de segurança que pode custar milhões. .gitignore protege você de acidentes e mantém repo limpo.

## Conteúdo

### O Que NUNCA Versionar

#### 1. Credenciais e Segredos

```gitignore
# Variáveis de ambiente
.env
.env.local
.env.production

# Arquivos de configuração com senhas
config/secrets.yml
credentials.json

# Chaves SSH/API
*.pem
*.key
id_rsa
id_ed25519
```

**Por quê:** Uma vez no Git, fica no histórico PARA SEMPRE. Mesmo deletando depois.

**Se já commitou senha:**
1. Revogue credencial IMEDIATAMENTE
2. Gere nova
3. Use `git filter-branch` ou BFG Repo Cleaner para remover do histórico

#### 2. Dependências (Baixáveis)

```gitignore
# Node.js
node_modules/
npm-debug.log
yarn-error.log

# Python
venv/
env/
ENV/
__pycache__/
*.pyc

# Ruby
vendor/bundle/

# Java
target/
*.class
```

**Por quê:**
- Arquivos grandes (node_modules pode ter 200MB+)
- Instaláveis via `npm install`, `pip install`, etc
- Diferentes por sistema operacional

#### 3. Arquivos de Build/Compilação

```gitignore
# Build outputs
dist/
build/
out/
*.min.js
*.bundle.js

# Logs de compilação
*.log
npm-debug.log*
```

**Por quê:** Gerados automaticamente, não fazem parte do código fonte.

#### 4. IDEs e Editores

```gitignore
# VS Code
.vscode/
*.code-workspace

# JetBrains (IntelliJ, PyCharm, WebStorm)
.idea/
*.iml

# Vim
*.swp
*.swo
*~

# Sublime Text
*.sublime-project
*.sublime-workspace
```

**Por quê:** Configurações pessoais, diferentes para cada dev.

#### 5. Sistema Operacional

```gitignore
# macOS
.DS_Store
.AppleDouble
.LSOverride

# Windows
Thumbs.db
ehthumbs.db
Desktop.ini

# Linux
*~
.directory
```

**Por quê:** Arquivos de sistema que não têm relação com projeto.

#### 6. Arquivos Temporários

```gitignore
# Temporários
*.tmp
*.temp
*.cache
.cache/

# Backup
*.bak
*.backup
*~
```

### .gitignore Completo por Linguagem

#### Node.js / JavaScript

```gitignore
# Dependências
node_modules/
jspm_packages/

# Logs
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# Testes
coverage/
.nyc_output

# Build
dist/
build/
.next/
out/

# Variáveis de ambiente
.env
.env.local
.env.*.local

# IDEs
.vscode/
.idea/

# Sistema
.DS_Store
Thumbs.db
```

#### Python

```gitignore
# Bytecode
__pycache__/
*.py[cod]
*$py.class

# Ambientes virtuais
venv/
env/
ENV/
.venv

# Distribution
dist/
build/
*.egg-info/

# Jupyter
.ipynb_checkpoints
*.ipynb_checkpoints

# Pytest
.pytest_cache/
.coverage
htmlcov/

# Variáveis de ambiente
.env
.env.local

# IDEs
.vscode/
.idea/
*.swp

# Sistema
.DS_Store
```

#### Java

```gitignore
# Compilados
*.class
*.jar
*.war
*.ear

# Build
target/
build/
out/

# Gradle
.gradle/
gradle-app.setting

# Maven
pom.xml.tag
dependency-reduced-pom.xml

# IDEs
.idea/
*.iml
.eclipse/
.settings/

# Logs
*.log

# Sistema
.DS_Store
```

### Padrões do .gitignore

#### Sintaxe básica

```gitignore
# Comentário

# Ignorar arquivo específico
config.local.js

# Ignorar todos arquivos com extensão
*.log

# Ignorar diretório
node_modules/

# Ignorar diretório em qualquer nível
**/temp/

# Negação - NÃO ignore este arquivo
!important.log

# Ignorar apenas no root
/README.local.md

# Ignorar em diretório específico
src/**/*.test.js
```

#### Exemplos práticos

```gitignore
# Ignore todos .env exceto exemplo
.env*
!.env.example

# Ignore builds mas não config
dist/
!dist/config/

# Ignore testes de todos os subdiretórios
**/*.test.js
**/__tests__/
```

### Templates Prontos

**GitHub oferece templates:** https://github.com/github/gitignore

Principais:
- [Node.gitignore](https://github.com/github/gitignore/blob/main/Node.gitignore)
- [Python.gitignore](https://github.com/github/gitignore/blob/main/Python.gitignore)
- [Java.gitignore](https://github.com/github/gitignore/blob/main/Java.gitignore)

**Site gerador:** [gitignore.io](https://www.toptal.com/developers/gitignore)

Escolha linguagem, IDE, OS → copia .gitignore pronto.

### Aplicando .gitignore

#### Criar arquivo

```bash
# No root do projeto
touch .gitignore

# Editar (VS Code)
code .gitignore
```

Cole conteúdo apropriado, salve.

#### Commitar

```bash
git add .gitignore
git commit -m "Add .gitignore for Node.js project"
```

**IMPORTANTE:** .gitignore deve ser versionado (commitado).

### Arquivo Já Foi Commitado?

.gitignore só afeta arquivos não rastreados. Se já fez commit, precisa remover do Git:

```bash
# Parar de rastrear arquivo (mantém no disco)
git rm --cached arquivo.env

# Parar de rastrear diretório
git rm -r --cached node_modules/

# Adicione ao .gitignore
echo "arquivo.env" >> .gitignore
echo "node_modules/" >> .gitignore

# Commit
git add .gitignore
git commit -m "Remove sensitive files and update .gitignore"
git push
```

**ATENÇÃO:** Arquivo ainda fica no histórico! Para remover completamente, use BFG Repo Cleaner.

### Ignorar Globalmente

Para arquivos que NUNCA quer versionar em NENHUM projeto:

```bash
# Crie .gitignore global
touch ~/.gitignore_global

# Configure Git para usá-lo
git config --global core.excludesfile ~/.gitignore_global
```

Adicione ao `~/.gitignore_global`:
```gitignore
# Sistema
.DS_Store
Thumbs.db

# IDEs (suas preferências)
.vscode/
.idea/

# Temporários
*.swp
*~
```

### Ver Arquivos Ignorados

```bash
# Listar arquivos ignorados
git status --ignored

# Ver se arquivo específico é ignorado
git check-ignore -v arquivo.txt
```

Saída:
```
.gitignore:5:*.txt    arquivo.txt
```

Indica que linha 5 do .gitignore está ignorando esse arquivo.

### .env.example Pattern

**Problema:** Precisa de .env mas não pode versionar (tem senhas).

**Solução:** Versione template sem valores sensíveis.

**.env** (NÃO versionar):
```env
DATABASE_URL=postgresql://user:SENHA_REAL@localhost/db
API_KEY=chave_secreta_123456
```

**.env.example** (versionar):
```env
DATABASE_URL=postgresql://user:password@localhost/dbname
API_KEY=your_api_key_here
```

**.gitignore:**
```gitignore
.env
.env.local
!.env.example
```

**README:**
```markdown
## Setup

1. Copy `.env.example` to `.env`
2. Fill in your actual credentials
```

### Troubleshooting

**Problema:** Adicionei ao .gitignore mas Git ainda rastreia.

**Causa:** Arquivo já estava sendo rastreado antes.

**Solução:**
```bash
git rm --cached arquivo
```

**Problema:** .gitignore não funciona.

**Checklist:**
- [ ] Arquivo chama `.gitignore` (com ponto no início)?
- [ ] Está no root do projeto?
- [ ] Sintaxe está correta?
- [ ] Arquivo já estava rastreado?

## Exercício Prático

```bash
cd github-practice-repo

# 1. Crie .env com "senha" fake
echo "API_KEY=secret123" > .env
echo "DATABASE_URL=postgres://localhost/db" >> .env

# 2. Veja que Git detecta
git status
# Mostra: .env como untracked

# 3. Crie .gitignore
cat > .gitignore << EOF
# Environment variables
.env
.env.local

# Dependencies (quando adicionar depois)
node_modules/

# Build
dist/
build/

# IDEs
.vscode/
.idea/

# Sistema
.DS_Store
Thumbs.db
EOF

# 4. Veja que .env sumiu do status
git status
# Não mostra mais .env, só .gitignore

# 5. Crie .env.example (template público)
cat > .env.example << EOF
API_KEY=your_api_key_here
DATABASE_URL=postgres://localhost/your_database
EOF

# 6. Commit .gitignore e .env.example
git add .gitignore .env.example
git commit -m "Add .gitignore and environment template"

# 7. Confirme que .env não foi incluído
git log --stat

# 8. Push
git push

# 9. Verifique no GitHub
# .env NÃO deve aparecer
# .gitignore e .env.example SIM
```

## Checkpoint

- [ ] Sei o que nunca versionar (senhas, node_modules, builds)
- [ ] Tenho .gitignore apropriado para minha linguagem
- [ ] Uso padrão .env.example para templates
- [ ] Sei remover arquivo já rastreado (git rm --cached)
- [ ] Meu .gitignore está versionado (commitado)
- [ ] Nunca mais vou commitar credenciais acidentalmente

## Próxima lição

Módulo 2 completo! Você domina o workflow individual. Agora vamos aprender colaboração profissional com branches. → **3.1 - Branches**
