# AULA 4.1: Desfazendo Erros

**Módulo:** 4 - Sobrevivência e Portfolio
**Duração:** 10 minutos
**Tipo:** Prático

---

## GPS DA AULA

### DESTINO (Onde você vai chegar)
Ao final desta aula, você vai:
- Usar git restore para descartar mudanças locais
- Usar git reset para desfazer commits locais
- Usar git revert para desfazer commits já pushed
- Usar git stash para guardar trabalho temporariamente
- Dominar a árvore de decisão de "qual comando usar"

### ORIGEM (De onde você vem)
Você provavelmente:
- Sabe o workflow completo de branches e PRs (Módulo 3)
- Já teve pânico quando errou no Git
- Não sabe a diferença entre reset e revert
- Talvez já tenha perdido código por não conhecer essas ferramentas

### ROTA (Como vamos chegar)
1. Entender que erros são normais
2. Aprender restore, reset, revert, stash
3. Dominar a árvore de decisão
4. Praticar cada comando

---

## ROTEIRO COMPLETO

### [ABERTURA] - 30 segundos

**[PROFESSOR DIZ:]**

> Você já commitou na branch errada? Já fez push de código quebrado? Já quis desfazer tudo e voltar pra trás?
>
> Bem-vindo ao clube. Todo desenvolvedor já passou por isso.
>
> O Git foi projetado pra desfazer. Você praticamente não consegue perder código permanentemente se souber usar as ferramentas certas.
>
> Nessa aula você vai perder o medo de errar. Bora.

---

### [POR QUE SABER DESFAZER IMPORTA] - 1 minuto

[SLIDE 1 - Mentalidade]

**[PROFESSOR DIZ:]**

> Antes dos comandos, ajusta a mentalidade.
>
> Erros acontecem SEMPRE. Commitou na branch errada. Mensagem de commit errada. Código quebrado foi pra main. Precisa mudar contexto urgente.
>
> [SLIDE 2 - Consequências]
>
> Se você não sabe desfazer:
>
> - Entra em pânico quando erra
> - Tem medo de experimentar
> - Pede ajuda pra coisas simples
> - Faz workarounds ruins
>
> [Pausa]
>
> Se você sabe desfazer:
>
> - Experimenta sem medo
> - Resolve seus próprios erros
> - Desenvolve com confiança
> - Autonomia total
>
> Git guarda tudo. Mesmo depois de reset, você pode recuperar.

---

### [GIT RESTORE - MUDANÇAS NÃO COMMITADAS] - 1 minuto 30 segundos

[SLIDE 3 - git restore]

**[PROFESSOR DIZ:]**

> Cenário: você editou um arquivo e quer descartar as mudanças. Voltar como estava no último commit.
>
> ```bash
> git restore index.js
> ```
>
> O arquivo volta ao estado do último commit. Simples.
>
> [SLIDE 4 - Restore staged]
>
> E se você fez `git add` mas quer tirar do staging?
>
> ```bash
> git restore --staged index.js
> ```
>
> Arquivo volta pra "unstaged" mas as mudanças continuam lá. Você só tirou do staging.
>
> [Pausa]
>
> Pra descartar TODAS as mudanças de uma vez:
>
> ```bash
> git restore .
> ```
>
> ATENÇÃO: mudanças são perdidas permanentemente! Use com cuidado.

---

### [GIT STASH - GUARDAR TEMPORARIAMENTE] - 2 minutos

[SLIDE 5 - Cenário de stash]

**[PROFESSOR DIZ:]**

> Cenário: você está trabalhando numa feature, mas precisa mudar de branch urgente. Código não está pronto pra commitar.
>
> Se tentar mudar de branch, Git reclama: "você tem mudanças não commitadas".
>
> Solução: stash.
>
> ```bash
> git stash
> ```
>
> [SLIDE 6 - Stash commands]
>
> O que acontece:
>
> - Suas mudanças são guardadas numa pilha temporária
> - Working directory fica limpo
> - Você pode mudar de branch tranquilo
>
> Pra recuperar depois:
>
> ```bash
> git stash pop
> ```
>
> Mudanças voltam. Stash é removido da pilha.
>
> [Pausa]
>
> Se quiser guardar com mensagem:
>
> ```bash
> git stash save "WIP: working on login form"
> ```
>
> Pra ver a lista de stashes:
>
> ```bash
> git stash list
> ```
>
> Stash é seu salva-vidas quando precisa mudar de contexto.

---

### [GIT RESET - DESFAZER COMMITS LOCAIS] - 2 minutos

[SLIDE 7 - 3 modos de reset]

**[PROFESSOR DIZ:]**

> Reset serve pra desfazer commits que você ainda NÃO fez push.
>
> Tem 3 modos. Vou explicar os dois que você vai usar.
>
> **Soft reset:** desfaz commit mas mantém mudanças no staging.
>
> ```bash
> git reset --soft HEAD~1
> ```
>
> O commit some, mas suas mudanças continuam prontas pra commitar de novo. Use quando quer editar mensagem ou adicionar arquivo esquecido.
>
> [SLIDE 8 - Hard reset]
>
> **Hard reset:** desfaz commit E descarta todas as mudanças.
>
> ```bash
> git reset --hard HEAD~1
> ```
>
> PERIGO! Mudanças são perdidas. Use só quando quer jogar tudo fora mesmo.
>
> [Pausa]
>
> HEAD~1 significa "um commit antes do atual". HEAD~3 seria três commits antes.
>
> IMPORTANTE: nunca use reset em commits que já foram pushed para branch compartilhada. Isso reescreve histórico e quebra o trabalho dos colegas.

---

### [GIT REVERT - DESFAZER COMMITS JÁ PUSHED] - 1 minuto 30 segundos

[SLIDE 9 - Revert vs Reset]

**[PROFESSOR DIZ:]**

> E se você já fez push? Não pode usar reset porque reescreve histórico.
>
> Solução: revert.
>
> ```bash
> git revert HEAD
> ```
>
> O que acontece: Git cria um NOVO commit que desfaz as mudanças do commit anterior. Histórico é preservado.
>
> [SLIDE 10 - Diagrama visual]
>
> Visualmente:
>
> Reset remove commits do histórico. Revert adiciona novo commit que desfaz.
>
> ```
> Reset:  A---B---C  → A---B (C sumiu)
> Revert: A---B---C  → A---B---C---D (D desfaz C)
> ```
>
> [Pausa]
>
> Pra reverter commit específico pelo hash:
>
> ```bash
> git revert abc1234
> ```
>
> Editor abre com mensagem padrão. Salve e feche.

---

### [GIT COMMIT --AMEND] - 1 minuto

[SLIDE 11 - Amend]

**[PROFESSOR DIZ:]**

> Caso especial: você commitou mas quer editar a mensagem ou adicionar arquivo esquecido.
>
> ```bash
> git commit --amend
> ```
>
> Editor abre com mensagem atual. Edite, salve, feche.
>
> Se esqueceu de adicionar arquivo:
>
> ```bash
> git add arquivo-esquecido.js
> git commit --amend --no-edit
> ```
>
> `--no-edit` mantém a mensagem atual.
>
> [Pausa]
>
> Amend reescreve o commit. Então, mesma regra: não use se já fez push.

---

### [ÁRVORE DE DECISÃO] - 1 minuto

[SLIDE 12 - Fluxograma]

**[PROFESSOR DIZ:]**

> Vou te dar a árvore de decisão que resolve 90% dos casos.
>
> Pergunta 1: Já commitou?
>
> - Não → use restore ou stash
>
> Pergunta 2: Já fez push?
>
> - Não → use reset ou amend
> - Sim → use revert
>
> [Pausa]
>
> Grava essa regra: push feito = use revert. Push não feito = pode usar reset.
>
> Se entrar em pânico total:
>
> ```bash
> git reflog
> ```
>
> Mostra histórico de onde HEAD esteve. Você pode voltar pra qualquer ponto.

---

### [EXERCÍCIO AO VIVO] - 2 minutos

[SLIDE 13 - Terminal]

**[PROFESSOR DIZ:]**

> Vamos praticar cada comando.
>
> ```bash
> cd github-practice-repo
>
> # 1. Teste restore
> echo "lixo" >> index.js
> git status  # Modified
> git restore index.js
> git status  # Clean
>
> # 2. Teste stash
> echo "function test() {}" >> utils.js
> git stash save "Testando stash"
> cat utils.js  # Linha sumiu
> git stash pop
> cat utils.js  # Linha voltou
> git restore utils.js  # Limpar
>
> # 3. Teste reset soft
> echo "feature" >> feature.js
> git add feature.js
> git commit -m "Add feature"
> git log --oneline  # Ver commit
> git reset --soft HEAD~1
> git status  # Mudanças voltaram pro staging
> ```
>
> [Pausa]
>
> Pronto. Você sabe desfazer erros. Não tenha mais medo de errar.

---

### [FECHAMENTO] - 30 segundos

[SLIDE 14 - Resumo]

**[PROFESSOR DIZ:]**

> Recapitulando:
>
> - `git restore` - descartar mudanças locais
> - `git stash` - guardar temporariamente
> - `git reset` - desfazer commits locais (NÃO pushed)
> - `git revert` - desfazer commits já pushed
> - `git commit --amend` - editar último commit
>
> Regra de ouro: push feito = revert. Push não feito = reset.
>
> E se der tudo errado: `git reflog` te salva.
>
> Na próxima aula, a gente vai construir seu perfil profissional no GitHub.
>
> Te vejo lá.

---

## CHECKLIST DE ENTENDIMENTO

- [ ] Sei usar `git restore` para descartar mudanças
- [ ] Sei usar `git stash` para guardar temporariamente
- [ ] Sei usar `git reset --soft` para desfazer commit local
- [ ] Sei usar `git revert` para desfazer commit já pushed
- [ ] Entendo a árvore de decisão: push feito = revert

---

## ARTEFATO DA AULA

```
AULA 4.1 - DESFAZENDO ERROS
===========================

PRÁTICA RESTORE:
[ ] Editei arquivo
[ ] Descartei com git restore
[ ] Arquivo voltou ao estado original

PRÁTICA STASH:
[ ] Fiz mudanças
[ ] Guardei com git stash
[ ] Recuperei com git stash pop

PRÁTICA RESET:
[ ] Fiz commit
[ ] Desfiz com git reset --soft HEAD~1
[ ] Mudanças voltaram para staging

ÁRVORE DE DECISÃO:
[ ] Sei quando usar restore vs reset vs revert
```

---

## PROMPT DE IA PARA ERROS GIT

```
Cometi erro no Git e preciso de ajuda.

SITUAÇÃO:
[descrever o que aconteceu]

JÁ FIZ PUSH?
[sim/não]

QUERO:
[descrever resultado desejado]

ME AJUDE COM:
1. Qual comando usar (restore, reset, revert, stash)
2. Passo a passo completo
3. O que verificar depois
4. Como evitar no futuro
```

---

## TROUBLESHOOTING

### Erro: "Cannot restore: file does not exist"

> Arquivo ainda não foi commitado.
> ```bash
> # Para arquivos novos (untracked)
> rm arquivo.js
> ```

### Erro: "You have unstaged changes"

> Tentou reset com mudanças pendentes.
> ```bash
> git stash
> git reset ...
> git stash pop
> ```

### Reset apagou meu trabalho!

> Git guarda tudo no reflog.
> ```bash
> git reflog
> # Encontre o commit perdido e volte
> git reset --hard HEAD@{X}
> ```

---

## ANEXO: SLIDES NECESSÁRIOS

| # | Título | Conteúdo |
|---|--------|----------|
| 1 | Mentalidade | Erros são normais |
| 2 | Consequências | Com vs sem saber desfazer |
| 3 | git restore | Descartar mudanças |
| 4 | Restore staged | --staged flag |
| 5 | Cenário stash | Mudança de contexto |
| 6 | Stash commands | save, pop, list |
| 7 | 3 modos reset | soft, mixed, hard |
| 8 | Hard reset | Perigo! |
| 9 | Revert vs Reset | Quando usar cada |
| 10 | Diagrama | Visual A-B-C-D |
| 11 | Amend | Editar último commit |
| 12 | Fluxograma | Árvore de decisão |
| 13 | Terminal | Exercício ao vivo |
| 14 | Resumo | Checklist visual |

---

## COMANDOS DA AULA (COPIAR E COLAR)

```bash
# Descartar mudanças locais
git restore arquivo.js

# Tirar do staging
git restore --staged arquivo.js

# Guardar temporariamente
git stash
git stash save "Descrição"

# Recuperar stash
git stash pop

# Desfazer commit local (mantém mudanças)
git reset --soft HEAD~1

# Desfazer commit local (descarta tudo)
git reset --hard HEAD~1

# Desfazer commit já pushed
git revert HEAD

# Editar último commit
git commit --amend

# Socorro! Ver histórico completo
git reflog
```

---

**Duração real:** 10 minutos
**Próximo:** Aula 4.2 - Perfil Profissional
