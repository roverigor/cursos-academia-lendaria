# 3.3 - Code Review

**Dura√ß√£o:** 13 min | **N√≠vel:** Iniciante

## Objetivo

Revisar c√≥digo de colegas de forma construtiva, fazer coment√°rios profissionais, e aprovar ou solicitar mudan√ßas seguindo boas pr√°ticas.

## Por que isso importa

Code review √© habilidade essencial em times profissionais. N√£o √© sobre achar erros, √© sobre elevar qualidade do c√≥digo e compartilhar conhecimento. Como voc√™ faz review diz muito sobre sua maturidade profissional e capacidade de colabora√ß√£o.

## Conte√∫do

### O Que √â Code Review?

**Code Review:** Processo onde desenvolvedores analisam c√≥digo de colegas antes de integrar ao projeto.

**Objetivos:**
1. **Qualidade:** Encontrar bugs, melhorias, edge cases
2. **Conhecimento:** Time aprende sobre mudan√ßas
3. **Padr√µes:** Garantir consist√™ncia de c√≥digo
4. **Mentor√≠a:** Desenvolvedores seniores guiam juniors

**N√£o √©:** Fiscaliza√ß√£o, cr√≠tica pessoal, ou barreira burocr√°tica.

### Mentalidade do Revisor

**‚úÖ Atitude correta:**
- Colaborativa, n√£o confrontacional
- Ensina e aprende simultaneamente
- Foca em c√≥digo, n√£o em pessoa
- Busca entender antes de criticar

**‚ùå Atitude errada:**
- Superioridade ("isso est√° horr√≠vel")
- Perfeccionismo ("reescreva tudo do meu jeito")
- Pressa ("LGTM" sem olhar realmente)
- Pessoal ("voc√™ n√£o sabe programar")

**Lembre:** Voc√™ est√° revisando **c√≥digo**, n√£o **pessoa**.

### Processo de Review no GitHub

#### 1. Acessar Pull Request

```
github.com/user/repo/pulls
  ‚Üì
Clique no PR que vai revisar
  ‚Üì
Aba "Files changed"
```

#### 2. Analisar Mudan√ßas

**Visualiza√ß√£o:**
```diff
+ linha adicionada (verde)
- linha removida (vermelho)
  linha sem mudan√ßa (branco)
```

**Navega√ß√£o:**
```
[Files changed]
  ‚îî‚îÄ src/auth/login.js (+45, -12)
     ‚îî‚îÄ Ver mudan√ßas linha por linha
```

#### 3. Fazer Coment√°rios

**Coment√°rio em linha espec√≠fica:**
1. Passe mouse sobre n√∫mero da linha
2. Clique no bot√£o `+` azul
3. Escreva coment√°rio
4. "Add single comment" (aparece imediatamente) ou "Start a review" (agrupa coment√°rios)

**Coment√°rio geral:**
- No topo da aba "Files changed"
- "Review changes" ‚Üí escreve coment√°rio geral

### Tipos de Coment√°rios

#### 1. Quest√µes (Perguntas)

**Quando:** Algo n√£o est√° claro.

**‚ùå Ruim:**
```
Isso est√° errado.
```

**‚úÖ Bom:**
```
Pode explicar por que escolheu Map em vez de Object aqui?
Estou tentando entender o trade-off.
```

#### 2. Sugest√µes (Melhorias)

**Quando:** Tem ideia de como melhorar.

**‚ùå Ruim:**
```
Esse nome de vari√°vel √© horr√≠vel.
```

**‚úÖ Bom:**
```
**Sugest√£o:** Que tal renomear `data` para `userProfile`?
Fica mais claro o que cont√©m.
```

**GitHub permite sugest√£o de c√≥digo:**

Clique no √≠cone de sugest√£o `¬±` ao fazer coment√°rio:

```diff
- const data = fetchUser();
+ const userProfile = fetchUser();
```

Autor pode aceitar com 1 clique ("Commit suggestion").

#### 3. Problemas (Bugs, Issues)

**Quando:** Encontra erro real.

**‚ùå Ruim:**
```
Isso vai quebrar em produ√ß√£o!
```

**‚úÖ Bom:**
```
‚ö†Ô∏è **Potencial bug:** Se `user.email` for `null`, essa linha vai lan√ßar TypeError.

**Sugest√£o:** Adicionar valida√ß√£o:
\`\`\`javascript
if (!user?.email) {
  return res.status(400).json({ error: 'Email required' });
}
\`\`\`
```

#### 4. Elogios (Reconhecimento)

**Quando:** Algo est√° muito bem feito.

**‚ùå N√£o fazer:**
S√≥ criticar, nunca elogiar.

**‚úÖ Fazer:**
```
üéØ Excelente uso de Promise.allSettled aqui!
Trata erros parciais perfeitamente.
```

**Elogios genu√≠nos:**
- Motivam colegas
- Refor√ßam boas pr√°ticas
- Criam cultura positiva

#### 5. Nitpicks (Detalhes Menores)

**Quando:** Detalhe pequeno, n√£o cr√≠tico.

```
**Nit:** Pequeno typo no coment√°rio: "recieve" ‚Üí "receive"

N√£o bloqueia merge, mas bom corrigir quando tiver chance.
```

**Prefixo "Nit:"** indica que n√£o √© essencial.

### Estrutura de Coment√°rio Profissional

**Formato:**
```
[Tipo] Observa√ß√£o clara

[Contexto] Por que isso importa

[Sugest√£o] Como melhorar (se aplic√°vel)
```

**Exemplo:**
```
**Preocupa√ß√£o de performance:** Esse loop aninhado tem complexidade O(n¬≤).

Com 1000 usu√°rios, vai processar 1 milh√£o de itera√ß√µes.
Em datasets grandes pode causar timeout.

**Sugest√£o:** Usar Map para lookup O(1):
\`\`\`javascript
const userMap = new Map(users.map(u => [u.id, u]));
orders.forEach(order => {
  const user = userMap.get(order.userId); // O(1)
});
\`\`\`
```

### Checklist de Code Review

Use esse checklist mental ao revisar:

#### Funcionalidade
- [ ] C√≥digo faz o que PR diz que faz?
- [ ] Testa casos extremos (null, vazio, grande)?
- [ ] Tratamento de erros est√° adequado?

#### Qualidade
- [ ] C√≥digo √© leg√≠vel e autoexplicativo?
- [ ] Nomes de vari√°veis/fun√ß√µes s√£o claros?
- [ ] Fun√ß√µes s√£o pequenas e focadas?
- [ ] N√£o h√° c√≥digo duplicado?

#### Seguran√ßa
- [ ] Inputs s√£o validados?
- [ ] Sem hardcoded secrets?
- [ ] Prote√ß√£o contra SQL injection, XSS?
- [ ] Dados sens√≠veis n√£o v√£o para logs?

#### Performance
- [ ] Sem loops desnecess√°rios?
- [ ] Queries de banco otimizadas?
- [ ] N√£o carrega dados que n√£o usa?

#### Testes
- [ ] Mudan√ßas est√£o testadas?
- [ ] Testes cobrem casos principais?
- [ ] Testes existentes ainda passam?

#### Documenta√ß√£o
- [ ] C√≥digo complexo tem coment√°rios?
- [ ] README atualizado se necess√°rio?
- [ ] API docs atualizadas?

**N√£o precisa ser perfeito:** Foque no que realmente importa. N√£o bloqueie PR por detalhes cosm√©ticos.

### Tipos de Review

#### 1. Approve (Aprovar)

**Quando:**
- C√≥digo est√° bom como est√°
- Mudan√ßas sugeridas s√£o opcionais (nits)

**Como:**
```
[Review changes] ‚Üí ‚óè Approve ‚Üí [Submit review]
```

**Mensagem:**
```
‚úÖ LGTM (Looks Good To Me)!

√ìtimo trabalho na implementa√ß√£o da autentica√ß√£o.
C√≥digo est√° claro, bem testado e segue nossos padr√µes.

Deixei uma sugest√£o de refactor como melhoria futura,
mas nada que bloqueie merge.
```

#### 2. Request Changes (Solicitar Mudan√ßas)

**Quando:**
- H√° bugs que precisam ser corrigidos
- Mudan√ßas cr√≠ticas antes de merge

**Como:**
```
[Review changes] ‚Üí ‚óè Request changes ‚Üí [Submit review]
```

**Mensagem:**
```
Implementa√ß√£o est√° no caminho certo! üëç

Encontrei alguns pontos que precisam de ajuste antes de merge:

1. **Valida√ß√£o de email:** Linha 42 - faltou validar formato
2. **Memory leak:** Linha 67 - EventListener n√£o √© removido
3. **Teste quebrado:** `test/auth.test.js` est√° falhing

Deixei coment√°rios detalhados em cada linha.
Ap√≥s corrigir, marco como approved!
```

#### 3. Comment (Comentar)

**Quando:**
- Quer dar feedback mas n√£o √© revisor oficial
- Ainda est√° analisando (review incompleto)

**Como:**
```
[Review changes] ‚Üí ‚óè Comment ‚Üí [Submit review]
```

### Respondendo Coment√°rios

#### Como Autor do PR

**Quando concordar:**
```
Boa observa√ß√£o! Vou ajustar conforme sugerido.
```

Depois:
- Faz commit com corre√ß√£o
- Responde: "‚úì Fixed in abc1234"
- Marca conversa como "Resolved"

**Quando discordar:**
```
Entendo sua preocupa√ß√£o, mas neste caso Map n√£o √©
necess√°rio porque dataset √© sempre < 10 items
(limitado por API).

Performance impacto seria neglig√≠vel. O que acha?
```

**Discuss√£o t√©cnica saud√°vel** √© esperada e bem-vinda!

**Quando n√£o entender:**
```
N√£o entendi completamente a sugest√£o.
Pode elaborar ou dar exemplo de como ficaria?
```

Pedir clarifica√ß√£o √© sinal de profissionalismo, n√£o fraqueza.

### Tom e Linguagem

#### Use linguagem inclusiva

**‚ùå Evite:**
```
Obviamente isso est√° errado.
Qualquer um sabe que...
Como voc√™ n√£o viu isso?
Isso √© b√°sico.
```

**‚úÖ Use:**
```
Podemos melhorar isso...
Uma alternativa seria...
Que tal considerar...
Sugiro...
```

#### Critique c√≥digo, n√£o pessoa

**‚ùå Evite:**
```
Voc√™ fez errado.
Voc√™ n√£o sabe async/await?
Voc√™ sempre faz isso.
```

**‚úÖ Use:**
```
Esse trecho pode ser melhorado.
Async/await simplificaria esse c√≥digo.
Vejo esse padr√£o em alguns lugares.
```

#### Use perguntas, n√£o ordens

**‚ùå Evite:**
```
Mude isso para arrow function.
```

**‚úÖ Use:**
```
Que tal usar arrow function aqui?
Mant√©m `this` do contexto pai.
```

#### Seja espec√≠fico

**‚ùå Vago:**
```
Melhorar performance.
```

**‚úÖ Espec√≠fico:**
```
**Performance:** Mover esse c√°lculo para fora do loop.
Est√° recalculando 1000 vezes desnecessariamente.
```

### Conflitos em Review

**Cen√°rio:** Voc√™ e autor discordam sobre abordagem.

**‚ùå N√£o fazer:**
- Insistir "do meu jeito ou nada"
- Apelar para autoridade: "Sou senior, fa√ßa como eu digo"
- Arrastar discuss√£o infinitamente

**‚úÖ Fazer:**
1. **Entenda perspectiva do outro**
   ```
   Entendo seu ponto sobre usar X.
   Minha preocupa√ß√£o √© Y. Como abordamos isso?
   ```

2. **Busque dados objetivos**
   ```
   Vamos verificar: X realmente tem melhor performance?
   [Link para benchmark/docs]
   ```

3. **Envolva terceiros se necess√°rio**
   ```
   @tech-lead que tal sua opini√£o sobre essa abordagem?
   ```

4. **Aceite que pode estar errado**
   ```
   Voc√™ tem raz√£o, n√£o tinha considerado esse √¢ngulo.
   Approved!
   ```

### Boas Pr√°ticas de Review

**‚úÖ Fa√ßa:**
- Revisar em at√© 24h (respeite tempo do colega)
- Elogiar bom c√≥digo
- Explicar **por qu√™** sugerir mudan√ßa
- Ser educado e respeitoso sempre
- Aprender com c√≥digo dos outros
- Fazer perguntas quando n√£o entender

**‚ùå Evite:**
- Reviewar s√≥ para criticar
- Deixar PR esperando dias
- Coment√°rios vagos: "n√£o gostei"
- Exigir que fa√ßam do seu jeito
- Ser condescendente
- Aprovar sem olhar ("LGTM" fake)

### Self-Review (Antes de Pedir Review)

**Antes de marcar algu√©m para review:**

1. **Revise seu pr√≥prio PR** na aba "Files changed"
2. **Procure:**
   - Console.logs esquecidos
   - Coment√°rios de debug
   - C√≥digo comentado n√£o usado
   - Formata√ß√£o inconsistente
   - TODOs que deveria resolver

3. **Adicione coment√°rios preventivos:**
```
# No seu pr√≥prio PR
"Sei que isso parece estranho, mas √© necess√°rio porque..."
```

Previne perguntas que voc√™ j√° sabe que vir√£o.

## Exerc√≠cio Pr√°tico

**Simule code review** (mesmo sendo seu pr√≥prio c√≥digo):

```bash
# 1. Crie PR de teste (se n√£o tiver um aberto)
git checkout -b feature/calculator
echo "function add(a, b) { return a + b; }" > calc.js
git add calc.js
git commit -m "Add calculator function"
git push -u origin feature/calculator

# 2. Abra PR no GitHub

# 3. Entre no PR, v√° em "Files changed"

# 4. Fa√ßa coment√°rios simulando review:

# Linha do function add:
```
**Sugest√£o:** Adicionar valida√ß√£o de tipos.

```javascript
function add(a, b) {
  if (typeof a !== 'number' || typeof b !== 'number') {
    throw new TypeError('Both arguments must be numbers');
  }
  return a + b;
}
```

Previne bugs quando chamar com strings: `add("2", "3")` ‚Üí "23"
```

# Coment√°rio geral:
```
Implementa√ß√£o b√°sica est√° boa, mas precisa de:
- ‚úÖ Valida√ß√£o de tipos
- ‚úÖ Testes unit√°rios
- ‚úÖ JSDoc para autocomplete
```

# 5. Pratique fazer sugest√£o de c√≥digo:
# - Clique em + na linha
# - Clique √≠cone ¬± (sugest√£o)
# - Edite c√≥digo
# - "Add single comment"

# 6. Simule aprova√ß√£o:
# - "Review changes"
# - "Approve"
# - Mensagem: "LGTM ap√≥s implementar sugest√µes!"
```

## Checkpoint

- [ ] Entendo que code review √© colabora√ß√£o, n√£o cr√≠tica
- [ ] Sei acessar "Files changed" e comentar em linhas
- [ ] Fa√ßo coment√°rios construtivos (por qu√™ + como)
- [ ] Uso approve / request changes / comment apropriadamente
- [ ] Cr√≠tico c√≥digo, n√£o pessoa
- [ ] Elogio quando c√≥digo est√° bom
- [ ] Respondo feedback de forma profissional

## Pr√≥xima li√ß√£o

Review completo! Agora vamos aprender o temido mas essencial: resolver conflitos de merge. ‚Üí **3.4 - Merge + Conflitos**
